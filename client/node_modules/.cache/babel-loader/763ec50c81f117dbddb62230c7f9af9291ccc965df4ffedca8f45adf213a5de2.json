{"ast":null,"code":"import React,{useState,useEffect,useMemo,useRef}from'react';import{Chessboard}from'react-chessboard';import{Chess}from'chess.js';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const formatMs=ms=>{const s=Math.max(0,Math.floor(ms/1000));const m=Math.floor(s/60);const sec=s%60;return\"\".concat(m,\":\").concat(sec.toString().padStart(2,'0'));};const pairMoves=sans=>{const rows=[];for(let i=0;i<sans.length;i+=2){rows.push({no:Math.floor(i/2)+1,w:sans[i]||'',b:sans[i+1]||''});}return rows;};const ComputerGame=()=>{const navigate=useNavigate();const[game,setGame]=useState(new Chess());const[difficulty,setDifficulty]=useState(5);const[isGameOver,setIsGameOver]=useState(false);const[result,setResult]=useState(null);const[isThinking,setIsThinking]=useState(false);const[playerColor,setPlayerColor]=useState('w');// w - белые, b - черные\nconst[isStockfishReady,setIsStockfishReady]=useState(false);const[isLoadingStockfish,setIsLoadingStockfish]=useState(true);const stockfishRef=useRef(null);// Контроль времени\nconst[minutes,setMinutes]=useState(5);const[increment,setIncrement]=useState(0);const[clock,setClock]=useState({wMs:minutes*60000,bMs:minutes*60000});const[lastTurnStartAt,setLastTurnStartAt]=useState(null);const[tick,setTick]=useState(0);// История ходов (SAN)\nconst[movesSan,setMovesSan]=useState([]);// Инициализация Stockfish (упрощенная версия как в Lichess)\nuseEffect(()=>{const initStockfish=async()=>{try{setIsLoadingStockfish(true);// Определяем путь к Stockfish для продакшна\nconst getStockfishPath=()=>{// В продакшне файлы находятся на hardcorechess.org\nif(window.location.hostname==='www.hardcorechess.org'){return'https://www.hardcorechess.org/stockfish-nnue-16-single.js';}// Локально используем относительный путь\nreturn'/stockfish-nnue-16-single.js';};// Простая реализация с fallback на CDN\nconst loadStockfish=()=>{return new Promise((resolve,reject)=>{const script=document.createElement('script');let attempts=0;const maxAttempts=2;const tryLoad=()=>{if(attempts===0){// Первая попытка - локальный файл или файл с продакшн сервера\nscript.src=getStockfishPath();console.log('Попытка загрузки Stockfish с:',script.src);}else if(attempts===1){// Вторая попытка - CDN\nscript.src='https://unpkg.com/stockfish@16.0.0/src/stockfish-nnue-16-single.js';console.log('Попытка загрузки Stockfish с CDN:',script.src);}else{console.log('Все попытки загрузки исчерпаны');reject(new Error('Stockfish не загружен'));return;}attempts++;document.head.appendChild(script);};script.onload=()=>{console.log('Stockfish скрипт загружен успешно');resolve();};script.onerror=()=>{console.log(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 Stockfish (\\u043F\\u043E\\u043F\\u044B\\u0442\\u043A\\u0430 \".concat(attempts,\")\"));script.remove();// Удаляем неудачный скрипт\ntryLoad();// Пробуем следующий источник\n};tryLoad();});};try{await loadStockfish();// Ждем инициализации\nawait new Promise(resolve=>setTimeout(resolve,1000));if(window.Stockfish){const stockfish=new window.Stockfish();stockfishRef.current=stockfish;stockfish.onmessage=event=>{const message=event.data||event;if(message.includes('uciok')){console.log('Stockfish готов к работе');setIsStockfishReady(true);setIsLoadingStockfish(false);}};stockfish.postMessage('uci');}else{throw new Error('Stockfish не найден в window');}}catch(error){console.log('Stockfish недоступен, используем простой ИИ');setIsLoadingStockfish(false);}}catch(error){console.error('Ошибка инициализации:',error);setIsLoadingStockfish(false);}};initStockfish();return()=>{if(stockfishRef.current){stockfishRef.current.terminate();}};},[]);useEffect(()=>{if(isStockfishReady){startNewGame();}},[isStockfishReady]);useEffect(()=>{if(!isGameOver&&playerColor==='b'&&game.turn()==='w'){makeComputerMove();}},[playerColor]);useEffect(()=>{const id=setInterval(()=>setTick(t=>t+1),200);return()=>clearInterval(id);},[]);const displayedClock=useMemo(()=>{if(isGameOver||lastTurnStartAt==null)return clock;const now=Date.now();const elapsed=Math.max(0,now-lastTurnStartAt);if(game.turn()==='w'){return{wMs:Math.max(0,clock.wMs-elapsed),bMs:clock.bMs};}else{return{wMs:clock.wMs,bMs:Math.max(0,clock.bMs-elapsed)};}},[clock,lastTurnStartAt,isGameOver,game,tick]);const resetClocks=(mins,inc)=>{const ms=mins*60000;setClock({wMs:ms,bMs:ms});setLastTurnStartAt(Date.now());};const startNewGame=()=>{const newGame=new Chess();setGame(newGame);setIsGameOver(false);setResult(null);setIsThinking(false);setMovesSan([]);resetClocks(minutes,increment);if(playerColor==='b'){setTimeout(()=>makeComputerMove(),50);}};const finishOnTime=loser=>{setIsGameOver(true);setResult(loser==='w'?'Поражение по времени (белые)':'Поражение по времени (чёрные)');};const settleTimeAfterMove=movedColor=>{const now=Date.now();if(lastTurnStartAt!=null){const elapsed=now-lastTurnStartAt;if(movedColor==='w'){const newW=Math.max(0,clock.wMs-elapsed)+increment*1000;if(newW<=0){finishOnTime('w');return false;}setClock({wMs:newW,bMs:clock.bMs});}else{const newB=Math.max(0,clock.bMs-elapsed)+increment*1000;if(newB<=0){finishOnTime('b');return false;}setClock({wMs:clock.wMs,bMs:newB});}}setLastTurnStartAt(now);return true;};const makeSimpleComputerMove=()=>{if(isGameOver||game.isGameOver())return;setIsThinking(true);setTimeout(()=>{try{const moves=game.moves();if(moves.length>0){// Простой алгоритм: случайный ход с небольшим приоритетом для взятий\nconst captures=moves.filter(move=>{const testGame=new Chess(game.fen());const moveObj=testGame.move(move);return moveObj&&moveObj.captured;});const moveToPlay=captures.length>0&&Math.random()<0.7?captures[Math.floor(Math.random()*captures.length)]:moves[Math.floor(Math.random()*moves.length)];const move=game.move(moveToPlay);if(move){setMovesSan(prev=>[...prev,move.san]);setGame(new Chess(game.fen()));const compColor=move.color;if(!settleTimeAfterMove(compColor)){setIsThinking(false);return;}if(game.isGameOver()){setIsGameOver(true);if(game.isCheckmate()){setResult(playerColor==='w'?'Победа чёрных!':'Победа белых!');}else if(game.isDraw()){setResult('Ничья!');}}}}}catch(error){console.error('Ошибка простого хода:',error);}finally{setIsThinking(false);}},500+Math.random()*1000);// Имитация размышления\n};const makeComputerMove=async()=>{try{if(isGameOver||game.isGameOver())return;// Если Stockfish не готов, используем простой алгоритм\nif(!isStockfishReady||!stockfishRef.current){makeSimpleComputerMove();return;}if(game.turn()!==playerColor){const now=Date.now();if(lastTurnStartAt!=null){const elapsed=now-lastTurnStartAt;const compColor=playerColor==='w'?'b':'w';const compMs=compColor==='w'?clock.wMs:clock.bMs;if(compMs-elapsed<=0){finishOnTime(compColor);return;}}}setIsThinking(true);return new Promise(resolve=>{const stockfish=stockfishRef.current;let bestMove=null;let resolved=false;// Таймаут для Stockfish (максимум 3 секунды)\nconst timeout=setTimeout(()=>{if(!resolved){console.log('Stockfish timeout, используем простой алгоритм');makeSimpleComputerMove();resolve();}},3000);const handleMessage=event=>{const message=event.data||event;if(message.includes('bestmove')){if(resolved)return;resolved=true;clearTimeout(timeout);const parts=message.split(' ');if(parts.length>=2){bestMove=parts[1];}if(bestMove&&bestMove!=='null'){try{const move=game.move(bestMove);if(move){setMovesSan(prev=>[...prev,move.san]);setGame(new Chess(game.fen()));const compColor=move.color;if(!settleTimeAfterMove(compColor)){setIsThinking(false);resolve();return;}if(game.isGameOver()){setIsGameOver(true);if(game.isCheckmate()){setResult(playerColor==='w'?'Победа чёрных!':'Победа белых!');}else if(game.isDraw()){setResult('Ничья!');}}}}catch(error){console.error('Ошибка выполнения хода:',error);}}setIsThinking(false);resolve();}};stockfish.onmessage=handleMessage;// Настройка сложности (упрощенная версия)\nconst depth=difficulty>=7?6:difficulty>=4?4:2;const skillLevel=Math.min(20,difficulty*2);stockfish.postMessage('setoption name Skill Level value '+skillLevel);stockfish.postMessage('position fen '+game.fen());stockfish.postMessage('go depth '+depth);});}catch(error){console.error('Ошибка в makeComputerMove:',error);setIsThinking(false);}};const handleMove=async(sourceSquare,targetSquare)=>{try{if(isGameOver||isThinking)return false;if(game.turn()!==playerColor)return false;const move=game.move({from:sourceSquare,to:targetSquare});if(!move)return false;setMovesSan(prev=>[...prev,move.san]);setGame(new Chess(game.fen()));if(!settleTimeAfterMove(move.color))return true;if(game.isGameOver()){setIsGameOver(true);if(game.isCheckmate()){setResult(playerColor==='w'?'Победа белых!':'Победа чёрных!');}else if(game.isDraw()){setResult('Ничья!');}return true;}setTimeout(()=>{makeComputerMove();},200);return true;}catch(error){// Просто возвращаем false, фигура вернется на место\nconsole.log('Неправильный ход:',error.message);return false;}};const changeDifficulty=newDifficulty=>{setDifficulty(newDifficulty);startNewGame();};const changePlayerColor=color=>{setPlayerColor(color);startNewGame();};const rows=useMemo(()=>pairMoves(movesSan),[movesSan]);return/*#__PURE__*/_jsxs(\"div\",{className:\"section\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/'),className:\"button\",style:{marginBottom:12},children:\"\\u041D\\u0430\\u0437\\u0430\\u0434\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0418\\u0433\\u0440\\u0430 \\u043F\\u0440\\u043E\\u0442\\u0438\\u0432 \\u043A\\u043E\\u043C\\u043F\\u044C\\u044E\\u0442\\u0435\\u0440\\u0430\"}),isLoadingStockfish&&/*#__PURE__*/_jsxs(\"div\",{className:\"panel\",style:{marginBottom:16,color:'#8ab4f8'},children:[\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u043B\\u0435\\u0433\\u043A\\u043E\\u0439 \\u0432\\u0435\\u0440\\u0441\\u0438\\u0438 Stockfish...\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:\"\\u0421\\u0435\\u0440\\u0432\\u0435\\u0440: hardcorechess.onrender.com | \\u041A\\u043B\\u0438\\u0435\\u043D\\u0442: hardcorechess.org\"})]}),isStockfishReady&&/*#__PURE__*/_jsx(\"div\",{className:\"panel\",style:{marginBottom:16,color:'#4caf50'},children:\"\\u2705 Stockfish \\u0433\\u043E\\u0442\\u043E\\u0432! \\u041A\\u043E\\u043C\\u043F\\u044C\\u044E\\u0442\\u0435\\u0440 \\u0431\\u0443\\u0434\\u0435\\u0442 \\u0438\\u0433\\u0440\\u0430\\u0442\\u044C \\u043D\\u0430 \\u043C\\u0430\\u043A\\u0441\\u0438\\u043C\\u0430\\u043B\\u044C\\u043D\\u043E\\u043C \\u0443\\u0440\\u043E\\u0432\\u043D\\u0435.\"}),!isStockfishReady&&!isLoadingStockfish&&/*#__PURE__*/_jsxs(\"div\",{className:\"panel\",style:{marginBottom:16,color:'#ffa726'},children:[\"\\u26A0\\uFE0F Stockfish \\u043D\\u0435 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0436\\u0435\\u043D. \\u0418\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u0443\\u0435\\u0442\\u0441\\u044F \\u0443\\u043F\\u0440\\u043E\\u0449\\u0435\\u043D\\u043D\\u044B\\u0439 \\u0418\\u0418.\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:\"\\u0418\\u0433\\u0440\\u0430 \\u0431\\u0443\\u0434\\u0435\\u0442 \\u0440\\u0430\\u0431\\u043E\\u0442\\u0430\\u0442\\u044C, \\u043D\\u043E \\u043A\\u043E\\u043C\\u043F\\u044C\\u044E\\u0442\\u0435\\u0440 \\u0431\\u0443\\u0434\\u0435\\u0442 \\u0438\\u0433\\u0440\\u0430\\u0442\\u044C \\u043F\\u0440\\u043E\\u0449\\u0435.\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:\"\\u041E\\u0442\\u043A\\u0440\\u043E\\u0439\\u0442\\u0435 \\u043A\\u043E\\u043D\\u0441\\u043E\\u043B\\u044C \\u0431\\u0440\\u0430\\u0443\\u0437\\u0435\\u0440\\u0430 (F12) \\u0434\\u043B\\u044F \\u0434\\u0438\\u0430\\u0433\\u043D\\u043E\\u0441\\u0442\\u0438\\u043A\\u0438.\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:\"\\u041D\\u0430 \\u043F\\u0440\\u043E\\u0434\\u0430\\u043A\\u0448\\u043D \\u0441\\u0435\\u0440\\u0432\\u0435\\u0440\\u0435 Stockfish \\u0434\\u043E\\u043B\\u0436\\u0435\\u043D \\u0440\\u0430\\u0431\\u043E\\u0442\\u0430\\u0442\\u044C \\u043B\\u0443\\u0447\\u0448\\u0435.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"game-layout\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"game-board\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',gap:16,marginBottom:16,flexWrap:'wrap'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel\",children:[/*#__PURE__*/_jsxs(\"label\",{style:{display:'block',marginBottom:6,fontWeight:'bold'},children:[\"\\u0421\\u043B\\u043E\\u0436\\u043D\\u043E\\u0441\\u0442\\u044C: \",difficulty,\"/10\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"1\",max:\"10\",value:difficulty,onChange:e=>changeDifficulty(parseInt(e.target.value)),style:{width:180}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"panel\",children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:6,fontWeight:'bold'},children:\"\\u0426\\u0432\\u0435\\u0442 \\u0444\\u0438\\u0433\\u0443\\u0440:\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>changePlayerColor('w'),className:\"button \".concat(playerColor==='w'?'primary':''),children:\"\\u0411\\u0435\\u043B\\u044B\\u0435\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>changePlayerColor('b'),className:\"button \".concat(playerColor==='b'?'primary':''),children:\"\\u0427\\u0451\\u0440\\u043D\\u044B\\u0435\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"panel\",children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:6,fontWeight:'bold'},children:\"\\u041A\\u043E\\u043D\\u0442\\u0440\\u043E\\u043B\\u044C \\u0432\\u0440\\u0435\\u043C\\u0435\\u043D\\u0438\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8,alignItems:'center'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:1,max:180,value:minutes,onChange:e=>{setMinutes(Number(e.target.value));resetClocks(Number(e.target.value),increment);},style:{width:80,padding:'8px',borderRadius:6,border:'1px solid #3a3a3a',background:'#2a2a2a',color:'#e6e6e6'}}),/*#__PURE__*/_jsx(\"span\",{className:\"kicker\",children:\"+\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:0,max:60,value:increment,onChange:e=>{setIncrement(Number(e.target.value));},style:{width:100,padding:'8px',borderRadius:6,border:'1px solid #3a3a3a',background:'#2a2a2a',color:'#e6e6e6'}}),/*#__PURE__*/_jsx(\"span\",{className:\"kicker\",children:\"\\u0441\\u0435\\u043A\"})]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:startNewGame,className:\"button\",style:{marginBottom:12},children:\"\\u041D\\u043E\\u0432\\u0430\\u044F \\u0438\\u0433\\u0440\\u0430\"}),/*#__PURE__*/_jsx(\"div\",{className:\"board-responsive\",children:/*#__PURE__*/_jsx(Chessboard,{position:game.fen(),onPieceDrop:handleMove,boardWidth:650,boardOrientation:playerColor==='w'?'white':'black'})}),isGameOver&&/*#__PURE__*/_jsx(\"div\",{className:\"panel\",style:{marginTop:12,color:'#ff8a80',fontWeight:'bold'},children:result}),isThinking&&/*#__PURE__*/_jsx(\"div\",{className:\"panel\",style:{marginTop:12,color:'#8ab4f8'},children:\"\\u041A\\u043E\\u043C\\u043F\\u044C\\u044E\\u0442\\u0435\\u0440 \\u0430\\u043D\\u0430\\u043B\\u0438\\u0437\\u0438\\u0440\\u0443\\u0435\\u0442 \\u043F\\u043E\\u0437\\u0438\\u0446\\u0438\\u044E\\u2026\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"game-sidebar\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel game-clock\",children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginTop:0},children:\"\\u0427\\u0430\\u0441\\u044B\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',gap:8},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u0411\\u0435\\u043B\\u044B\\u0435\"}),/*#__PURE__*/_jsx(\"strong\",{children:formatMs(displayedClock.wMs)})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u0427\\u0451\\u0440\\u043D\\u044B\\u0435\"}),/*#__PURE__*/_jsx(\"strong\",{children:formatMs(displayedClock.bMs)})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"panel game-history\",children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginTop:0},children:\"\\u0418\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F \\u0445\\u043E\\u0434\\u043E\\u0432\"}),rows.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"kicker\",children:\"\\u041F\\u043E\\u043A\\u0430 \\u043D\\u0435\\u0442 \\u0445\\u043E\\u0434\\u043E\\u0432\"}):/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{textAlign:'left',width:40},children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{style:{textAlign:'left'},children:\"\\u0411\\u0435\\u043B\\u044B\\u0435\"}),/*#__PURE__*/_jsx(\"th\",{style:{textAlign:'left'},children:\"\\u0427\\u0451\\u0440\\u043D\\u044B\\u0435\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:rows.map(r=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[r.no,\".\"]}),/*#__PURE__*/_jsx(\"td\",{children:r.w}),/*#__PURE__*/_jsx(\"td\",{children:r.b})]},r.no))})]})]})]})]})]});};export default ComputerGame;","map":{"version":3,"names":["React","useState","useEffect","useMemo","useRef","Chessboard","Chess","useNavigate","jsx","_jsx","jsxs","_jsxs","formatMs","ms","s","Math","max","floor","m","sec","concat","toString","padStart","pairMoves","sans","rows","i","length","push","no","w","b","ComputerGame","navigate","game","setGame","difficulty","setDifficulty","isGameOver","setIsGameOver","result","setResult","isThinking","setIsThinking","playerColor","setPlayerColor","isStockfishReady","setIsStockfishReady","isLoadingStockfish","setIsLoadingStockfish","stockfishRef","minutes","setMinutes","increment","setIncrement","clock","setClock","wMs","bMs","lastTurnStartAt","setLastTurnStartAt","tick","setTick","movesSan","setMovesSan","initStockfish","getStockfishPath","window","location","hostname","loadStockfish","Promise","resolve","reject","script","document","createElement","attempts","maxAttempts","tryLoad","src","console","log","Error","head","appendChild","onload","onerror","remove","setTimeout","Stockfish","stockfish","current","onmessage","event","message","data","includes","postMessage","error","terminate","startNewGame","turn","makeComputerMove","id","setInterval","t","clearInterval","displayedClock","now","Date","elapsed","resetClocks","mins","inc","newGame","finishOnTime","loser","settleTimeAfterMove","movedColor","newW","newB","makeSimpleComputerMove","moves","captures","filter","move","testGame","fen","moveObj","captured","moveToPlay","random","prev","san","compColor","color","isCheckmate","isDraw","compMs","bestMove","resolved","timeout","handleMessage","clearTimeout","parts","split","depth","skillLevel","min","handleMove","sourceSquare","targetSquare","from","to","changeDifficulty","newDifficulty","changePlayerColor","className","children","onClick","style","marginBottom","display","justifyContent","gap","flexWrap","fontWeight","type","value","onChange","e","parseInt","target","width","alignItems","Number","padding","borderRadius","border","background","position","onPieceDrop","boardWidth","boardOrientation","marginTop","flexDirection","borderCollapse","textAlign","map","r"],"sources":["/home/kirtan-rasa/hardcorechess/client/src/components/ComputerGame.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { Chessboard } from 'react-chessboard';\nimport { Chess } from 'chess.js';\nimport { useNavigate } from 'react-router-dom';\n\nconst formatMs = (ms) => {\n  const s = Math.max(0, Math.floor(ms / 1000));\n  const m = Math.floor(s / 60);\n  const sec = s % 60;\n  return `${m}:${sec.toString().padStart(2, '0')}`;\n};\n\nconst pairMoves = (sans) => {\n  const rows = [];\n  for (let i = 0; i < sans.length; i += 2) {\n    rows.push({ no: Math.floor(i / 2) + 1, w: sans[i] || '', b: sans[i + 1] || '' });\n  }\n  return rows;\n};\n\nconst ComputerGame = () => {\n  const navigate = useNavigate();\n  const [game, setGame] = useState(new Chess());\n  const [difficulty, setDifficulty] = useState(5);\n  const [isGameOver, setIsGameOver] = useState(false);\n  const [result, setResult] = useState(null);\n  const [isThinking, setIsThinking] = useState(false);\n  const [playerColor, setPlayerColor] = useState('w'); // w - белые, b - черные\n  const [isStockfishReady, setIsStockfishReady] = useState(false);\n  const [isLoadingStockfish, setIsLoadingStockfish] = useState(true);\n  const stockfishRef = useRef(null);\n\n  // Контроль времени\n  const [minutes, setMinutes] = useState(5);\n  const [increment, setIncrement] = useState(0);\n  const [clock, setClock] = useState({ wMs: minutes * 60000, bMs: minutes * 60000 });\n  const [lastTurnStartAt, setLastTurnStartAt] = useState(null);\n  const [tick, setTick] = useState(0);\n\n  // История ходов (SAN)\n  const [movesSan, setMovesSan] = useState([]);\n\n  // Инициализация Stockfish (упрощенная версия как в Lichess)\n  useEffect(() => {\n    const initStockfish = async () => {\n      try {\n        setIsLoadingStockfish(true);\n        \n        // Определяем путь к Stockfish для продакшна\n        const getStockfishPath = () => {\n          // В продакшне файлы находятся на hardcorechess.org\n          if (window.location.hostname === 'www.hardcorechess.org') {\n            return 'https://www.hardcorechess.org/stockfish-nnue-16-single.js';\n          }\n          // Локально используем относительный путь\n          return '/stockfish-nnue-16-single.js';\n        };\n\n        // Простая реализация с fallback на CDN\n        const loadStockfish = () => {\n          return new Promise((resolve, reject) => {\n            const script = document.createElement('script');\n            let attempts = 0;\n            const maxAttempts = 2;\n            \n            const tryLoad = () => {\n              if (attempts === 0) {\n                // Первая попытка - локальный файл или файл с продакшн сервера\n                script.src = getStockfishPath();\n                console.log('Попытка загрузки Stockfish с:', script.src);\n              } else if (attempts === 1) {\n                // Вторая попытка - CDN\n                script.src = 'https://unpkg.com/stockfish@16.0.0/src/stockfish-nnue-16-single.js';\n                console.log('Попытка загрузки Stockfish с CDN:', script.src);\n              } else {\n                console.log('Все попытки загрузки исчерпаны');\n                reject(new Error('Stockfish не загружен'));\n                return;\n              }\n              \n              attempts++;\n              document.head.appendChild(script);\n            };\n            \n            script.onload = () => {\n              console.log('Stockfish скрипт загружен успешно');\n              resolve();\n            };\n            \n            script.onerror = () => {\n              console.log(`Ошибка загрузки Stockfish (попытка ${attempts})`);\n              script.remove(); // Удаляем неудачный скрипт\n              tryLoad(); // Пробуем следующий источник\n            };\n            \n            tryLoad();\n          });\n        };\n        \n        try {\n          await loadStockfish();\n          \n          // Ждем инициализации\n          await new Promise(resolve => setTimeout(resolve, 1000));\n          \n          if (window.Stockfish) {\n            const stockfish = new window.Stockfish();\n            stockfishRef.current = stockfish;\n            \n            stockfish.onmessage = (event) => {\n              const message = event.data || event;\n              if (message.includes('uciok')) {\n                console.log('Stockfish готов к работе');\n                setIsStockfishReady(true);\n                setIsLoadingStockfish(false);\n              }\n            };\n            \n            stockfish.postMessage('uci');\n          } else {\n            throw new Error('Stockfish не найден в window');\n          }\n        } catch (error) {\n          console.log('Stockfish недоступен, используем простой ИИ');\n          setIsLoadingStockfish(false);\n        }\n      } catch (error) {\n        console.error('Ошибка инициализации:', error);\n        setIsLoadingStockfish(false);\n      }\n    };\n    \n    initStockfish();\n    \n    return () => {\n      if (stockfishRef.current) {\n        stockfishRef.current.terminate();\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (isStockfishReady) {\n      startNewGame();\n    }\n  }, [isStockfishReady]);\n\n  useEffect(() => {\n    if (!isGameOver && playerColor === 'b' && game.turn() === 'w') {\n      makeComputerMove();\n    }\n  }, [playerColor]);\n\n  useEffect(() => {\n    const id = setInterval(() => setTick((t) => t + 1), 200);\n    return () => clearInterval(id);\n  }, []);\n\n  const displayedClock = useMemo(() => {\n    if (isGameOver || lastTurnStartAt == null) return clock;\n    const now = Date.now();\n    const elapsed = Math.max(0, now - lastTurnStartAt);\n    if (game.turn() === 'w') {\n      return { wMs: Math.max(0, clock.wMs - elapsed), bMs: clock.bMs };\n    } else {\n      return { wMs: clock.wMs, bMs: Math.max(0, clock.bMs - elapsed) };\n    }\n  }, [clock, lastTurnStartAt, isGameOver, game, tick]);\n\n  const resetClocks = (mins, inc) => {\n    const ms = mins * 60000;\n    setClock({ wMs: ms, bMs: ms });\n    setLastTurnStartAt(Date.now());\n  };\n\n  const startNewGame = () => {\n    const newGame = new Chess();\n    setGame(newGame);\n    setIsGameOver(false);\n    setResult(null);\n    setIsThinking(false);\n    setMovesSan([]);\n    resetClocks(minutes, increment);\n    if (playerColor === 'b') {\n      setTimeout(() => makeComputerMove(), 50);\n    }\n  };\n\n  const finishOnTime = (loser) => {\n    setIsGameOver(true);\n    setResult(loser === 'w' ? 'Поражение по времени (белые)' : 'Поражение по времени (чёрные)');\n  };\n\n  const settleTimeAfterMove = (movedColor) => {\n    const now = Date.now();\n    if (lastTurnStartAt != null) {\n      const elapsed = now - lastTurnStartAt;\n      if (movedColor === 'w') {\n        const newW = Math.max(0, clock.wMs - elapsed) + increment * 1000;\n        if (newW <= 0) { finishOnTime('w'); return false; }\n        setClock({ wMs: newW, bMs: clock.bMs });\n      } else {\n        const newB = Math.max(0, clock.bMs - elapsed) + increment * 1000;\n        if (newB <= 0) { finishOnTime('b'); return false; }\n        setClock({ wMs: clock.wMs, bMs: newB });\n      }\n    }\n    setLastTurnStartAt(now);\n    return true;\n  };\n\n  const makeSimpleComputerMove = () => {\n    if (isGameOver || game.isGameOver()) return;\n    \n    setIsThinking(true);\n    \n    setTimeout(() => {\n      try {\n        const moves = game.moves();\n        if (moves.length > 0) {\n          // Простой алгоритм: случайный ход с небольшим приоритетом для взятий\n          const captures = moves.filter(move => {\n            const testGame = new Chess(game.fen());\n            const moveObj = testGame.move(move);\n            return moveObj && moveObj.captured;\n          });\n          \n          const moveToPlay = captures.length > 0 && Math.random() < 0.7 \n            ? captures[Math.floor(Math.random() * captures.length)]\n            : moves[Math.floor(Math.random() * moves.length)];\n          \n          const move = game.move(moveToPlay);\n          if (move) {\n            setMovesSan(prev => [...prev, move.san]);\n            setGame(new Chess(game.fen()));\n            const compColor = move.color;\n            if (!settleTimeAfterMove(compColor)) {\n              setIsThinking(false);\n              return;\n            }\n\n            if (game.isGameOver()) {\n              setIsGameOver(true);\n              if (game.isCheckmate()) {\n                setResult(playerColor === 'w' ? 'Победа чёрных!' : 'Победа белых!');\n              } else if (game.isDraw()) {\n                setResult('Ничья!');\n              }\n            }\n          }\n        }\n      } catch (error) {\n        console.error('Ошибка простого хода:', error);\n      } finally {\n        setIsThinking(false);\n      }\n    }, 500 + Math.random() * 1000); // Имитация размышления\n  };\n\n  const makeComputerMove = async () => {\n    try {\n      if (isGameOver || game.isGameOver()) return;\n      \n      // Если Stockfish не готов, используем простой алгоритм\n      if (!isStockfishReady || !stockfishRef.current) {\n        makeSimpleComputerMove();\n        return;\n      }\n\n      if (game.turn() !== playerColor) {\n        const now = Date.now();\n        if (lastTurnStartAt != null) {\n          const elapsed = now - lastTurnStartAt;\n          const compColor = playerColor === 'w' ? 'b' : 'w';\n          const compMs = compColor === 'w' ? clock.wMs : clock.bMs;\n          if (compMs - elapsed <= 0) {\n            finishOnTime(compColor);\n            return;\n          }\n        }\n      }\n\n      setIsThinking(true);\n      \n      return new Promise((resolve) => {\n        const stockfish = stockfishRef.current;\n        let bestMove = null;\n        let resolved = false;\n        \n        // Таймаут для Stockfish (максимум 3 секунды)\n        const timeout = setTimeout(() => {\n          if (!resolved) {\n            console.log('Stockfish timeout, используем простой алгоритм');\n            makeSimpleComputerMove();\n            resolve();\n          }\n        }, 3000);\n        \n        const handleMessage = (event) => {\n          const message = event.data || event;\n          \n          if (message.includes('bestmove')) {\n            if (resolved) return;\n            resolved = true;\n            clearTimeout(timeout);\n            \n            const parts = message.split(' ');\n            if (parts.length >= 2) {\n              bestMove = parts[1];\n            }\n            \n            if (bestMove && bestMove !== 'null') {\n              try {\n                const move = game.move(bestMove);\n                if (move) {\n                  setMovesSan(prev => [...prev, move.san]);\n                  setGame(new Chess(game.fen()));\n                  const compColor = move.color;\n                  if (!settleTimeAfterMove(compColor)) {\n                    setIsThinking(false);\n                    resolve();\n                    return;\n                  }\n\n                  if (game.isGameOver()) {\n                    setIsGameOver(true);\n                    if (game.isCheckmate()) {\n                      setResult(playerColor === 'w' ? 'Победа чёрных!' : 'Победа белых!');\n                    } else if (game.isDraw()) {\n                      setResult('Ничья!');\n                    }\n                  }\n                }\n              } catch (error) {\n                console.error('Ошибка выполнения хода:', error);\n              }\n            }\n            \n            setIsThinking(false);\n            resolve();\n          }\n        };\n        \n        stockfish.onmessage = handleMessage;\n        \n        // Настройка сложности (упрощенная версия)\n        const depth = difficulty >= 7 ? 6 : difficulty >= 4 ? 4 : 2;\n        const skillLevel = Math.min(20, difficulty * 2);\n        \n        stockfish.postMessage('setoption name Skill Level value ' + skillLevel);\n        stockfish.postMessage('position fen ' + game.fen());\n        stockfish.postMessage('go depth ' + depth);\n      });\n    } catch (error) {\n      console.error('Ошибка в makeComputerMove:', error);\n      setIsThinking(false);\n    }\n  };\n\n  const handleMove = async (sourceSquare, targetSquare) => {\n    try {\n      if (isGameOver || isThinking) return false;\n      if (game.turn() !== playerColor) return false;\n\n      const move = game.move({ from: sourceSquare, to: targetSquare });\n      if (!move) return false;\n\n      setMovesSan(prev => [...prev, move.san]);\n      setGame(new Chess(game.fen()));\n\n      if (!settleTimeAfterMove(move.color)) return true;\n\n      if (game.isGameOver()) {\n        setIsGameOver(true);\n        if (game.isCheckmate()) {\n          setResult(playerColor === 'w' ? 'Победа белых!' : 'Победа чёрных!');\n        } else if (game.isDraw()) {\n          setResult('Ничья!');\n        }\n        return true;\n      }\n\n      setTimeout(() => { makeComputerMove(); }, 200);\n      return true;\n    } catch (error) {\n      // Просто возвращаем false, фигура вернется на место\n      console.log('Неправильный ход:', error.message);\n      return false;\n    }\n  };\n\n  const changeDifficulty = (newDifficulty) => {\n    setDifficulty(newDifficulty);\n    startNewGame();\n  };\n\n  const changePlayerColor = (color) => {\n    setPlayerColor(color);\n    startNewGame();\n  };\n\n  const rows = useMemo(() => pairMoves(movesSan), [movesSan]);\n\n  return (\n    <div className=\"section\">\n      <button \n        onClick={() => navigate('/')}\n        className=\"button\"\n        style={{ marginBottom: 12 }}\n      >\n        Назад\n      </button>\n      \n      <h2>Игра против компьютера</h2>\n\n      {isLoadingStockfish && (\n        <div className=\"panel\" style={{ marginBottom: 16, color: '#8ab4f8' }}>\n          Загрузка легкой версии Stockfish...\n          <br />\n          <small>Сервер: hardcorechess.onrender.com | Клиент: hardcorechess.org</small>\n        </div>\n      )}\n\n      {isStockfishReady && (\n        <div className=\"panel\" style={{ marginBottom: 16, color: '#4caf50' }}>\n          ✅ Stockfish готов! Компьютер будет играть на максимальном уровне.\n        </div>\n      )}\n\n      {!isStockfishReady && !isLoadingStockfish && (\n        <div className=\"panel\" style={{ marginBottom: 16, color: '#ffa726' }}>\n          ⚠️ Stockfish не загружен. Используется упрощенный ИИ.\n          <br />\n          <small>Игра будет работать, но компьютер будет играть проще.</small>\n          <br />\n          <small>Откройте консоль браузера (F12) для диагностики.</small>\n          <br />\n          <small>На продакшн сервере Stockfish должен работать лучше.</small>\n        </div>\n      )}\n\n      <div className=\"game-layout\">\n        <div className=\"game-board\">\n          <div style={{ display: 'flex', justifyContent: 'center', gap: 16, marginBottom: 16, flexWrap: 'wrap' }}>\n            <div className=\"panel\">\n              <label style={{ display: 'block', marginBottom: 6, fontWeight: 'bold' }}>\n                Сложность: {difficulty}/10\n              </label>\n              <input\n                type=\"range\"\n                min=\"1\"\n                max=\"10\"\n                value={difficulty}\n                onChange={(e) => changeDifficulty(parseInt(e.target.value))}\n                style={{ width: 180 }}\n              />\n            </div>\n            \n            <div className=\"panel\">\n              <label style={{ display: 'block', marginBottom: 6, fontWeight: 'bold' }}>\n                Цвет фигур:\n              </label>\n              <div style={{ display: 'flex', gap: 8 }}>\n                <button\n                  onClick={() => changePlayerColor('w')}\n                  className={`button ${playerColor === 'w' ? 'primary' : ''}`}\n                >\n                  Белые\n                </button>\n                <button\n                  onClick={() => changePlayerColor('b')}\n                  className={`button ${playerColor === 'b' ? 'primary' : ''}`}\n                >\n                  Чёрные\n                </button>\n              </div>\n            </div>\n\n            <div className=\"panel\">\n              <label style={{ display: 'block', marginBottom: 6, fontWeight: 'bold' }}>Контроль времени</label>\n              <div style={{ display: 'flex', gap: 8, alignItems: 'center' }}>\n                <input type=\"number\" min={1} max={180} value={minutes}\n                  onChange={(e) => { setMinutes(Number(e.target.value)); resetClocks(Number(e.target.value), increment); }}\n                  style={{ width: 80, padding: '8px', borderRadius: 6, border: '1px solid #3a3a3a', background: '#2a2a2a', color: '#e6e6e6' }} />\n                <span className=\"kicker\">+</span>\n                <input type=\"number\" min={0} max={60} value={increment}\n                  onChange={(e) => { setIncrement(Number(e.target.value)); }}\n                  style={{ width: 100, padding: '8px', borderRadius: 6, border: '1px solid #3a3a3a', background: '#2a2a2a', color: '#e6e6e6' }} />\n                <span className=\"kicker\">сек</span>\n              </div>\n            </div>\n          </div>\n          \n          <button onClick={startNewGame} className=\"button\" style={{ marginBottom: 12 }}>\n            Новая игра\n          </button>\n          \n          <div className=\"board-responsive\">\n            <Chessboard\n              position={game.fen()}\n              onPieceDrop={handleMove}\n              boardWidth={650}\n              boardOrientation={playerColor === 'w' ? 'white' : 'black'}\n            />\n          </div>\n\n          {isGameOver && (\n            <div className=\"panel\" style={{ marginTop: 12, color: '#ff8a80', fontWeight: 'bold' }}>\n              {result}\n            </div>\n          )}\n          \n          {isThinking && (\n            <div className=\"panel\" style={{ marginTop: 12, color: '#8ab4f8' }}>\n              Компьютер анализирует позицию…\n            </div>\n          )}\n        </div>\n\n        <div className=\"game-sidebar\">\n          <div className=\"panel game-clock\">\n            <h3 style={{ marginTop: 0 }}>Часы</h3>\n            <div style={{ display: 'flex', flexDirection: 'column', gap: 8 }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                <span>Белые</span>\n                <strong>{formatMs(displayedClock.wMs)}</strong>\n              </div>\n              <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                <span>Чёрные</span>\n                <strong>{formatMs(displayedClock.bMs)}</strong>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"panel game-history\">\n            <h3 style={{ marginTop: 0 }}>История ходов</h3>\n            {rows.length === 0 ? (\n              <p className=\"kicker\">Пока нет ходов</p>\n            ) : (\n              <table style={{ width: '100%', borderCollapse: 'collapse' }}>\n                <thead>\n                  <tr>\n                    <th style={{ textAlign: 'left', width: 40 }}>#</th>\n                    <th style={{ textAlign: 'left' }}>Белые</th>\n                    <th style={{ textAlign: 'left' }}>Чёрные</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {rows.map((r) => (\n                    <tr key={r.no}>\n                      <td>{r.no}.</td>\n                      <td>{r.w}</td>\n                      <td>{r.b}</td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ComputerGame;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}