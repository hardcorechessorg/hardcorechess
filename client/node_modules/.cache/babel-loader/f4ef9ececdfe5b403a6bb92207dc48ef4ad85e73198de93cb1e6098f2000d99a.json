{"ast":null,"code":"import React,{useState,useEffect,useMemo,useRef}from'react';import{Chessboard}from'react-chessboard';import{Chess}from'chess.js';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const formatMs=ms=>{const s=Math.max(0,Math.floor(ms/1000));const m=Math.floor(s/60);const sec=s%60;return\"\".concat(m,\":\").concat(sec.toString().padStart(2,'0'));};const pairMoves=sans=>{const rows=[];for(let i=0;i<sans.length;i+=2){rows.push({no:Math.floor(i/2)+1,w:sans[i]||'',b:sans[i+1]||''});}return rows;};const ComputerGame=()=>{const navigate=useNavigate();const[game,setGame]=useState(new Chess());const[difficulty,setDifficulty]=useState(5);const[isGameOver,setIsGameOver]=useState(false);const[result,setResult]=useState(null);const[isThinking,setIsThinking]=useState(false);const[playerColor,setPlayerColor]=useState('w');// w - белые, b - черные\nconst[isStockfishReady,setIsStockfishReady]=useState(false);const[isLoadingStockfish,setIsLoadingStockfish]=useState(true);const stockfishRef=useRef(null);// Контроль времени\nconst[minutes,setMinutes]=useState(5);const[increment,setIncrement]=useState(0);const[clock,setClock]=useState({wMs:minutes*60000,bMs:minutes*60000});const[lastTurnStartAt,setLastTurnStartAt]=useState(null);const[tick,setTick]=useState(0);// История ходов (SAN)\nconst[movesSan,setMovesSan]=useState([]);// Инициализация Stockfish\nuseEffect(()=>{const initStockfish=async()=>{try{setIsLoadingStockfish(true);// Загружаем Stockfish через скрипт с fallback\nif(!window.Stockfish){const script=document.createElement('script');// Пробуем сначала локальный файл, потом CDN\nconst tryLocalFirst=()=>{script.src='/stockfish-nnue-16-single.js';console.log('Пробуем загрузить локальный Stockfish...');};const tryCDN=()=>{script.src='https://unpkg.com/stockfish@16.0.0/src/stockfish-nnue-16-single.js';console.log('Пробуем загрузить Stockfish с CDN...');};let attempt=0;const maxAttempts=2;const loadScript=()=>{if(attempt===0){tryLocalFirst();}else if(attempt===1){tryCDN();}else{console.log('Все попытки загрузки Stockfish исчерпаны, используем простой ИИ');setIsLoadingStockfish(false);return;}attempt++;};// Таймаут для загрузки скрипта\nconst scriptTimeout=setTimeout(()=>{console.log('Stockfish скрипт не загрузился, используем простой ИИ');setIsLoadingStockfish(false);},15000);script.onload=()=>{clearTimeout(scriptTimeout);try{// Ждем немного, чтобы Stockfish полностью инициализировался\nsetTimeout(()=>{if(window.Stockfish&&typeof window.Stockfish==='function'){try{const stockfish=new window.Stockfish();stockfishRef.current=stockfish;stockfish.onmessage=event=>{const message=event.data||event;console.log('Stockfish message:',message);if(message.includes('uciok')){setIsStockfishReady(true);setIsLoadingStockfish(false);}};stockfish.postMessage('uci');}catch(error){console.error('Ошибка создания Stockfish:',error);setIsLoadingStockfish(false);}}else{console.error('Stockfish не инициализирован');setIsLoadingStockfish(false);}},500);}catch(error){console.error('Ошибка создания Stockfish:',error);setIsLoadingStockfish(false);}};script.onerror=()=>{console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 Stockfish (\\u043F\\u043E\\u043F\\u044B\\u0442\\u043A\\u0430 \".concat(attempt,\")\"));if(attempt<maxAttempts){loadScript();}else{clearTimeout(scriptTimeout);setIsLoadingStockfish(false);}};loadScript();document.head.appendChild(script);}else{try{const stockfish=new window.Stockfish();stockfishRef.current=stockfish;stockfish.onmessage=event=>{const message=event.data||event;console.log('Stockfish message:',message);if(message.includes('uciok')){setIsStockfishReady(true);setIsLoadingStockfish(false);}};stockfish.postMessage('uci');}catch(error){console.error('Ошибка создания Stockfish:',error);setIsLoadingStockfish(false);}}}catch(error){console.error('Ошибка инициализации Stockfish:',error);setIsLoadingStockfish(false);}};initStockfish();return()=>{if(stockfishRef.current){stockfishRef.current.terminate();}};},[]);useEffect(()=>{if(isStockfishReady){startNewGame();}},[isStockfishReady]);useEffect(()=>{if(!isGameOver&&playerColor==='b'&&game.turn()==='w'){makeComputerMove();}},[playerColor]);useEffect(()=>{const id=setInterval(()=>setTick(t=>t+1),200);return()=>clearInterval(id);},[]);const displayedClock=useMemo(()=>{if(isGameOver||lastTurnStartAt==null)return clock;const now=Date.now();const elapsed=Math.max(0,now-lastTurnStartAt);if(game.turn()==='w'){return{wMs:Math.max(0,clock.wMs-elapsed),bMs:clock.bMs};}else{return{wMs:clock.wMs,bMs:Math.max(0,clock.bMs-elapsed)};}},[clock,lastTurnStartAt,isGameOver,game,tick]);const resetClocks=(mins,inc)=>{const ms=mins*60000;setClock({wMs:ms,bMs:ms});setLastTurnStartAt(Date.now());};const startNewGame=()=>{const newGame=new Chess();setGame(newGame);setIsGameOver(false);setResult(null);setIsThinking(false);setMovesSan([]);resetClocks(minutes,increment);if(playerColor==='b'){setTimeout(()=>makeComputerMove(),50);}};const finishOnTime=loser=>{setIsGameOver(true);setResult(loser==='w'?'Поражение по времени (белые)':'Поражение по времени (чёрные)');};const settleTimeAfterMove=movedColor=>{const now=Date.now();if(lastTurnStartAt!=null){const elapsed=now-lastTurnStartAt;if(movedColor==='w'){const newW=Math.max(0,clock.wMs-elapsed)+increment*1000;if(newW<=0){finishOnTime('w');return false;}setClock({wMs:newW,bMs:clock.bMs});}else{const newB=Math.max(0,clock.bMs-elapsed)+increment*1000;if(newB<=0){finishOnTime('b');return false;}setClock({wMs:clock.wMs,bMs:newB});}}setLastTurnStartAt(now);return true;};const makeSimpleComputerMove=()=>{if(isGameOver||game.isGameOver())return;setIsThinking(true);setTimeout(()=>{try{const moves=game.moves();if(moves.length>0){// Простой алгоритм: случайный ход с небольшим приоритетом для взятий\nconst captures=moves.filter(move=>{const testGame=new Chess(game.fen());const moveObj=testGame.move(move);return moveObj&&moveObj.captured;});const moveToPlay=captures.length>0&&Math.random()<0.7?captures[Math.floor(Math.random()*captures.length)]:moves[Math.floor(Math.random()*moves.length)];const move=game.move(moveToPlay);if(move){setMovesSan(prev=>[...prev,move.san]);setGame(new Chess(game.fen()));const compColor=move.color;if(!settleTimeAfterMove(compColor)){setIsThinking(false);return;}if(game.isGameOver()){setIsGameOver(true);if(game.isCheckmate()){setResult(playerColor==='w'?'Победа чёрных!':'Победа белых!');}else if(game.isDraw()){setResult('Ничья!');}}}}}catch(error){console.error('Ошибка простого хода:',error);}finally{setIsThinking(false);}},500+Math.random()*1000);// Имитация размышления\n};const makeComputerMove=async()=>{try{if(isGameOver||game.isGameOver())return;// Если Stockfish не готов, используем простой алгоритм\nif(!isStockfishReady||!stockfishRef.current){makeSimpleComputerMove();return;}if(game.turn()!==playerColor){const now=Date.now();if(lastTurnStartAt!=null){const elapsed=now-lastTurnStartAt;const compColor=playerColor==='w'?'b':'w';const compMs=compColor==='w'?clock.wMs:clock.bMs;if(compMs-elapsed<=0){finishOnTime(compColor);return;}}}setIsThinking(true);return new Promise(resolve=>{const stockfish=stockfishRef.current;let bestMove=null;let resolved=false;// Таймаут для Stockfish (максимум 5 секунд)\nconst timeout=setTimeout(()=>{if(!resolved){console.log('Stockfish timeout, используем простой алгоритм');stockfish.removeEventListener('message',handleMessage);makeSimpleComputerMove();resolve();}},5000);const handleMessage=event=>{const message=event.data||event;if(message.includes('bestmove')){if(resolved)return;resolved=true;clearTimeout(timeout);const parts=message.split(' ');if(parts.length>=2){bestMove=parts[1];}stockfish.removeEventListener('message',handleMessage);if(bestMove&&bestMove!=='null'){try{const move=game.move(bestMove);if(move){setMovesSan(prev=>[...prev,move.san]);setGame(new Chess(game.fen()));const compColor=move.color;if(!settleTimeAfterMove(compColor)){setIsThinking(false);resolve();return;}if(game.isGameOver()){setIsGameOver(true);if(game.isCheckmate()){setResult(playerColor==='w'?'Победа чёрных!':'Победа белых!');}else if(game.isDraw()){setResult('Ничья!');}}}}catch(error){console.error('Ошибка выполнения хода:',error);}}setIsThinking(false);resolve();}};stockfish.addEventListener('message',handleMessage);// Настройка сложности через UCI параметры (оптимизировано для скорости)\nconst depth=difficulty>=9?8:difficulty>=7?6:difficulty>=4?4:2;const skillLevel=Math.min(20,difficulty*2);const timeLimit=difficulty>=7?2000:difficulty>=4?1000:500;// лимит времени в мс\nstockfish.postMessage('setoption name Skill Level value '+skillLevel);stockfish.postMessage('setoption name Threads value 1');// один поток для скорости\nstockfish.postMessage('setoption name Hash value 16');// меньше памяти\nstockfish.postMessage('position fen '+game.fen());stockfish.postMessage('go depth '+depth+' movetime '+timeLimit);});}catch(error){console.error('Ошибка в makeComputerMove:',error);setIsThinking(false);}};const handleMove=async(sourceSquare,targetSquare)=>{try{if(isGameOver||isThinking)return false;if(game.turn()!==playerColor)return false;const move=game.move({from:sourceSquare,to:targetSquare});if(!move)return false;setMovesSan(prev=>[...prev,move.san]);setGame(new Chess(game.fen()));if(!settleTimeAfterMove(move.color))return true;if(game.isGameOver()){setIsGameOver(true);if(game.isCheckmate()){setResult(playerColor==='w'?'Победа белых!':'Победа чёрных!');}else if(game.isDraw()){setResult('Ничья!');}return true;}setTimeout(()=>{makeComputerMove();},200);return true;}catch(error){// Просто возвращаем false, фигура вернется на место\nconsole.log('Неправильный ход:',error.message);return false;}};const changeDifficulty=newDifficulty=>{setDifficulty(newDifficulty);startNewGame();};const changePlayerColor=color=>{setPlayerColor(color);startNewGame();};const rows=useMemo(()=>pairMoves(movesSan),[movesSan]);return/*#__PURE__*/_jsxs(\"div\",{className:\"section\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/'),className:\"button\",style:{marginBottom:12},children:\"\\u041D\\u0430\\u0437\\u0430\\u0434\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0418\\u0433\\u0440\\u0430 \\u043F\\u0440\\u043E\\u0442\\u0438\\u0432 \\u043A\\u043E\\u043C\\u043F\\u044C\\u044E\\u0442\\u0435\\u0440\\u0430\"}),isLoadingStockfish&&/*#__PURE__*/_jsx(\"div\",{className:\"panel\",style:{marginBottom:16,color:'#8ab4f8'},children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u043B\\u0435\\u0433\\u043A\\u043E\\u0439 \\u0432\\u0435\\u0440\\u0441\\u0438\\u0438 Stockfish...\"}),!isStockfishReady&&!isLoadingStockfish&&/*#__PURE__*/_jsxs(\"div\",{className:\"panel\",style:{marginBottom:16,color:'#ffa726'},children:[\"\\u26A0\\uFE0F Stockfish \\u043D\\u0435 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0436\\u0435\\u043D. \\u0418\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u0443\\u0435\\u0442\\u0441\\u044F \\u0443\\u043F\\u0440\\u043E\\u0449\\u0435\\u043D\\u043D\\u044B\\u0439 \\u0418\\u0418.\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:\"\\u0418\\u0433\\u0440\\u0430 \\u0431\\u0443\\u0434\\u0435\\u0442 \\u0440\\u0430\\u0431\\u043E\\u0442\\u0430\\u0442\\u044C, \\u043D\\u043E \\u043A\\u043E\\u043C\\u043F\\u044C\\u044E\\u0442\\u0435\\u0440 \\u0431\\u0443\\u0434\\u0435\\u0442 \\u0438\\u0433\\u0440\\u0430\\u0442\\u044C \\u043F\\u0440\\u043E\\u0449\\u0435.\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:\"\\u041E\\u0442\\u043A\\u0440\\u043E\\u0439\\u0442\\u0435 \\u043A\\u043E\\u043D\\u0441\\u043E\\u043B\\u044C \\u0431\\u0440\\u0430\\u0443\\u0437\\u0435\\u0440\\u0430 (F12) \\u0434\\u043B\\u044F \\u0434\\u0438\\u0430\\u0433\\u043D\\u043E\\u0441\\u0442\\u0438\\u043A\\u0438.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"game-layout\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"game-board\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',gap:16,marginBottom:16,flexWrap:'wrap'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel\",children:[/*#__PURE__*/_jsxs(\"label\",{style:{display:'block',marginBottom:6,fontWeight:'bold'},children:[\"\\u0421\\u043B\\u043E\\u0436\\u043D\\u043E\\u0441\\u0442\\u044C: \",difficulty,\"/10\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"1\",max:\"10\",value:difficulty,onChange:e=>changeDifficulty(parseInt(e.target.value)),style:{width:180}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"panel\",children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:6,fontWeight:'bold'},children:\"\\u0426\\u0432\\u0435\\u0442 \\u0444\\u0438\\u0433\\u0443\\u0440:\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>changePlayerColor('w'),className:\"button \".concat(playerColor==='w'?'primary':''),children:\"\\u0411\\u0435\\u043B\\u044B\\u0435\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>changePlayerColor('b'),className:\"button \".concat(playerColor==='b'?'primary':''),children:\"\\u0427\\u0451\\u0440\\u043D\\u044B\\u0435\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"panel\",children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:6,fontWeight:'bold'},children:\"\\u041A\\u043E\\u043D\\u0442\\u0440\\u043E\\u043B\\u044C \\u0432\\u0440\\u0435\\u043C\\u0435\\u043D\\u0438\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8,alignItems:'center'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:1,max:180,value:minutes,onChange:e=>{setMinutes(Number(e.target.value));resetClocks(Number(e.target.value),increment);},style:{width:80,padding:'8px',borderRadius:6,border:'1px solid #3a3a3a',background:'#2a2a2a',color:'#e6e6e6'}}),/*#__PURE__*/_jsx(\"span\",{className:\"kicker\",children:\"+\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:0,max:60,value:increment,onChange:e=>{setIncrement(Number(e.target.value));},style:{width:100,padding:'8px',borderRadius:6,border:'1px solid #3a3a3a',background:'#2a2a2a',color:'#e6e6e6'}}),/*#__PURE__*/_jsx(\"span\",{className:\"kicker\",children:\"\\u0441\\u0435\\u043A\"})]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:startNewGame,className:\"button\",style:{marginBottom:12},children:\"\\u041D\\u043E\\u0432\\u0430\\u044F \\u0438\\u0433\\u0440\\u0430\"}),/*#__PURE__*/_jsx(\"div\",{className:\"board-responsive\",children:/*#__PURE__*/_jsx(Chessboard,{position:game.fen(),onPieceDrop:handleMove,boardWidth:650,boardOrientation:playerColor==='w'?'white':'black'})}),isGameOver&&/*#__PURE__*/_jsx(\"div\",{className:\"panel\",style:{marginTop:12,color:'#ff8a80',fontWeight:'bold'},children:result}),isThinking&&/*#__PURE__*/_jsx(\"div\",{className:\"panel\",style:{marginTop:12,color:'#8ab4f8'},children:\"\\u041A\\u043E\\u043C\\u043F\\u044C\\u044E\\u0442\\u0435\\u0440 \\u0430\\u043D\\u0430\\u043B\\u0438\\u0437\\u0438\\u0440\\u0443\\u0435\\u0442 \\u043F\\u043E\\u0437\\u0438\\u0446\\u0438\\u044E\\u2026\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"game-sidebar\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel game-clock\",children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginTop:0},children:\"\\u0427\\u0430\\u0441\\u044B\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',gap:8},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u0411\\u0435\\u043B\\u044B\\u0435\"}),/*#__PURE__*/_jsx(\"strong\",{children:formatMs(displayedClock.wMs)})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u0427\\u0451\\u0440\\u043D\\u044B\\u0435\"}),/*#__PURE__*/_jsx(\"strong\",{children:formatMs(displayedClock.bMs)})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"panel game-history\",children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginTop:0},children:\"\\u0418\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F \\u0445\\u043E\\u0434\\u043E\\u0432\"}),rows.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"kicker\",children:\"\\u041F\\u043E\\u043A\\u0430 \\u043D\\u0435\\u0442 \\u0445\\u043E\\u0434\\u043E\\u0432\"}):/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{textAlign:'left',width:40},children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{style:{textAlign:'left'},children:\"\\u0411\\u0435\\u043B\\u044B\\u0435\"}),/*#__PURE__*/_jsx(\"th\",{style:{textAlign:'left'},children:\"\\u0427\\u0451\\u0440\\u043D\\u044B\\u0435\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:rows.map(r=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[r.no,\".\"]}),/*#__PURE__*/_jsx(\"td\",{children:r.w}),/*#__PURE__*/_jsx(\"td\",{children:r.b})]},r.no))})]})]})]})]})]});};export default ComputerGame;","map":{"version":3,"names":["React","useState","useEffect","useMemo","useRef","Chessboard","Chess","useNavigate","jsx","_jsx","jsxs","_jsxs","formatMs","ms","s","Math","max","floor","m","sec","concat","toString","padStart","pairMoves","sans","rows","i","length","push","no","w","b","ComputerGame","navigate","game","setGame","difficulty","setDifficulty","isGameOver","setIsGameOver","result","setResult","isThinking","setIsThinking","playerColor","setPlayerColor","isStockfishReady","setIsStockfishReady","isLoadingStockfish","setIsLoadingStockfish","stockfishRef","minutes","setMinutes","increment","setIncrement","clock","setClock","wMs","bMs","lastTurnStartAt","setLastTurnStartAt","tick","setTick","movesSan","setMovesSan","initStockfish","window","Stockfish","script","document","createElement","tryLocalFirst","src","console","log","tryCDN","attempt","maxAttempts","loadScript","scriptTimeout","setTimeout","onload","clearTimeout","stockfish","current","onmessage","event","message","data","includes","postMessage","error","onerror","head","appendChild","terminate","startNewGame","turn","makeComputerMove","id","setInterval","t","clearInterval","displayedClock","now","Date","elapsed","resetClocks","mins","inc","newGame","finishOnTime","loser","settleTimeAfterMove","movedColor","newW","newB","makeSimpleComputerMove","moves","captures","filter","move","testGame","fen","moveObj","captured","moveToPlay","random","prev","san","compColor","color","isCheckmate","isDraw","compMs","Promise","resolve","bestMove","resolved","timeout","removeEventListener","handleMessage","parts","split","addEventListener","depth","skillLevel","min","timeLimit","handleMove","sourceSquare","targetSquare","from","to","changeDifficulty","newDifficulty","changePlayerColor","className","children","onClick","style","marginBottom","display","justifyContent","gap","flexWrap","fontWeight","type","value","onChange","e","parseInt","target","width","alignItems","Number","padding","borderRadius","border","background","position","onPieceDrop","boardWidth","boardOrientation","marginTop","flexDirection","borderCollapse","textAlign","map","r"],"sources":["/home/kirtan-rasa/hardcorechess/client/src/components/ComputerGame.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { Chessboard } from 'react-chessboard';\nimport { Chess } from 'chess.js';\nimport { useNavigate } from 'react-router-dom';\n\nconst formatMs = (ms) => {\n  const s = Math.max(0, Math.floor(ms / 1000));\n  const m = Math.floor(s / 60);\n  const sec = s % 60;\n  return `${m}:${sec.toString().padStart(2, '0')}`;\n};\n\nconst pairMoves = (sans) => {\n  const rows = [];\n  for (let i = 0; i < sans.length; i += 2) {\n    rows.push({ no: Math.floor(i / 2) + 1, w: sans[i] || '', b: sans[i + 1] || '' });\n  }\n  return rows;\n};\n\nconst ComputerGame = () => {\n  const navigate = useNavigate();\n  const [game, setGame] = useState(new Chess());\n  const [difficulty, setDifficulty] = useState(5);\n  const [isGameOver, setIsGameOver] = useState(false);\n  const [result, setResult] = useState(null);\n  const [isThinking, setIsThinking] = useState(false);\n  const [playerColor, setPlayerColor] = useState('w'); // w - белые, b - черные\n  const [isStockfishReady, setIsStockfishReady] = useState(false);\n  const [isLoadingStockfish, setIsLoadingStockfish] = useState(true);\n  const stockfishRef = useRef(null);\n\n  // Контроль времени\n  const [minutes, setMinutes] = useState(5);\n  const [increment, setIncrement] = useState(0);\n  const [clock, setClock] = useState({ wMs: minutes * 60000, bMs: minutes * 60000 });\n  const [lastTurnStartAt, setLastTurnStartAt] = useState(null);\n  const [tick, setTick] = useState(0);\n\n  // История ходов (SAN)\n  const [movesSan, setMovesSan] = useState([]);\n\n  // Инициализация Stockfish\n  useEffect(() => {\n    const initStockfish = async () => {\n      try {\n        setIsLoadingStockfish(true);\n        \n        // Загружаем Stockfish через скрипт с fallback\n        if (!window.Stockfish) {\n          const script = document.createElement('script');\n          \n          // Пробуем сначала локальный файл, потом CDN\n          const tryLocalFirst = () => {\n            script.src = '/stockfish-nnue-16-single.js';\n            console.log('Пробуем загрузить локальный Stockfish...');\n          };\n          \n          const tryCDN = () => {\n            script.src = 'https://unpkg.com/stockfish@16.0.0/src/stockfish-nnue-16-single.js';\n            console.log('Пробуем загрузить Stockfish с CDN...');\n          };\n          \n          let attempt = 0;\n          const maxAttempts = 2;\n          \n          const loadScript = () => {\n            if (attempt === 0) {\n              tryLocalFirst();\n            } else if (attempt === 1) {\n              tryCDN();\n            } else {\n              console.log('Все попытки загрузки Stockfish исчерпаны, используем простой ИИ');\n              setIsLoadingStockfish(false);\n              return;\n            }\n            attempt++;\n          };\n          \n          // Таймаут для загрузки скрипта\n          const scriptTimeout = setTimeout(() => {\n            console.log('Stockfish скрипт не загрузился, используем простой ИИ');\n            setIsLoadingStockfish(false);\n          }, 15000);\n          \n          script.onload = () => {\n            clearTimeout(scriptTimeout);\n            try {\n              // Ждем немного, чтобы Stockfish полностью инициализировался\n              setTimeout(() => {\n                if (window.Stockfish && typeof window.Stockfish === 'function') {\n                  try {\n                    const stockfish = new window.Stockfish();\n                    stockfishRef.current = stockfish;\n                    \n                    stockfish.onmessage = (event) => {\n                      const message = event.data || event;\n                      console.log('Stockfish message:', message);\n                      if (message.includes('uciok')) {\n                        setIsStockfishReady(true);\n                        setIsLoadingStockfish(false);\n                      }\n                    };\n                    \n                    stockfish.postMessage('uci');\n                  } catch (error) {\n                    console.error('Ошибка создания Stockfish:', error);\n                    setIsLoadingStockfish(false);\n                  }\n                } else {\n                  console.error('Stockfish не инициализирован');\n                  setIsLoadingStockfish(false);\n                }\n              }, 500);\n            } catch (error) {\n              console.error('Ошибка создания Stockfish:', error);\n              setIsLoadingStockfish(false);\n            }\n          };\n          \n          script.onerror = () => {\n            console.error(`Ошибка загрузки Stockfish (попытка ${attempt})`);\n            if (attempt < maxAttempts) {\n              loadScript();\n            } else {\n              clearTimeout(scriptTimeout);\n              setIsLoadingStockfish(false);\n            }\n          };\n          \n          loadScript();\n          document.head.appendChild(script);\n        } else {\n          try {\n            const stockfish = new window.Stockfish();\n            stockfishRef.current = stockfish;\n            \n            stockfish.onmessage = (event) => {\n              const message = event.data || event;\n              console.log('Stockfish message:', message);\n              if (message.includes('uciok')) {\n                setIsStockfishReady(true);\n                setIsLoadingStockfish(false);\n              }\n            };\n            \n            stockfish.postMessage('uci');\n          } catch (error) {\n            console.error('Ошибка создания Stockfish:', error);\n            setIsLoadingStockfish(false);\n          }\n        }\n      } catch (error) {\n        console.error('Ошибка инициализации Stockfish:', error);\n        setIsLoadingStockfish(false);\n      }\n    };\n    \n    initStockfish();\n    \n    return () => {\n      if (stockfishRef.current) {\n        stockfishRef.current.terminate();\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (isStockfishReady) {\n      startNewGame();\n    }\n  }, [isStockfishReady]);\n\n  useEffect(() => {\n    if (!isGameOver && playerColor === 'b' && game.turn() === 'w') {\n      makeComputerMove();\n    }\n  }, [playerColor]);\n\n  useEffect(() => {\n    const id = setInterval(() => setTick((t) => t + 1), 200);\n    return () => clearInterval(id);\n  }, []);\n\n  const displayedClock = useMemo(() => {\n    if (isGameOver || lastTurnStartAt == null) return clock;\n    const now = Date.now();\n    const elapsed = Math.max(0, now - lastTurnStartAt);\n    if (game.turn() === 'w') {\n      return { wMs: Math.max(0, clock.wMs - elapsed), bMs: clock.bMs };\n    } else {\n      return { wMs: clock.wMs, bMs: Math.max(0, clock.bMs - elapsed) };\n    }\n  }, [clock, lastTurnStartAt, isGameOver, game, tick]);\n\n  const resetClocks = (mins, inc) => {\n    const ms = mins * 60000;\n    setClock({ wMs: ms, bMs: ms });\n    setLastTurnStartAt(Date.now());\n  };\n\n  const startNewGame = () => {\n    const newGame = new Chess();\n    setGame(newGame);\n    setIsGameOver(false);\n    setResult(null);\n    setIsThinking(false);\n    setMovesSan([]);\n    resetClocks(minutes, increment);\n    if (playerColor === 'b') {\n      setTimeout(() => makeComputerMove(), 50);\n    }\n  };\n\n  const finishOnTime = (loser) => {\n    setIsGameOver(true);\n    setResult(loser === 'w' ? 'Поражение по времени (белые)' : 'Поражение по времени (чёрные)');\n  };\n\n  const settleTimeAfterMove = (movedColor) => {\n    const now = Date.now();\n    if (lastTurnStartAt != null) {\n      const elapsed = now - lastTurnStartAt;\n      if (movedColor === 'w') {\n        const newW = Math.max(0, clock.wMs - elapsed) + increment * 1000;\n        if (newW <= 0) { finishOnTime('w'); return false; }\n        setClock({ wMs: newW, bMs: clock.bMs });\n      } else {\n        const newB = Math.max(0, clock.bMs - elapsed) + increment * 1000;\n        if (newB <= 0) { finishOnTime('b'); return false; }\n        setClock({ wMs: clock.wMs, bMs: newB });\n      }\n    }\n    setLastTurnStartAt(now);\n    return true;\n  };\n\n  const makeSimpleComputerMove = () => {\n    if (isGameOver || game.isGameOver()) return;\n    \n    setIsThinking(true);\n    \n    setTimeout(() => {\n      try {\n        const moves = game.moves();\n        if (moves.length > 0) {\n          // Простой алгоритм: случайный ход с небольшим приоритетом для взятий\n          const captures = moves.filter(move => {\n            const testGame = new Chess(game.fen());\n            const moveObj = testGame.move(move);\n            return moveObj && moveObj.captured;\n          });\n          \n          const moveToPlay = captures.length > 0 && Math.random() < 0.7 \n            ? captures[Math.floor(Math.random() * captures.length)]\n            : moves[Math.floor(Math.random() * moves.length)];\n          \n          const move = game.move(moveToPlay);\n          if (move) {\n            setMovesSan(prev => [...prev, move.san]);\n            setGame(new Chess(game.fen()));\n            const compColor = move.color;\n            if (!settleTimeAfterMove(compColor)) {\n              setIsThinking(false);\n              return;\n            }\n\n            if (game.isGameOver()) {\n              setIsGameOver(true);\n              if (game.isCheckmate()) {\n                setResult(playerColor === 'w' ? 'Победа чёрных!' : 'Победа белых!');\n              } else if (game.isDraw()) {\n                setResult('Ничья!');\n              }\n            }\n          }\n        }\n      } catch (error) {\n        console.error('Ошибка простого хода:', error);\n      } finally {\n        setIsThinking(false);\n      }\n    }, 500 + Math.random() * 1000); // Имитация размышления\n  };\n\n  const makeComputerMove = async () => {\n    try {\n      if (isGameOver || game.isGameOver()) return;\n      \n      // Если Stockfish не готов, используем простой алгоритм\n      if (!isStockfishReady || !stockfishRef.current) {\n        makeSimpleComputerMove();\n        return;\n      }\n\n      if (game.turn() !== playerColor) {\n        const now = Date.now();\n        if (lastTurnStartAt != null) {\n          const elapsed = now - lastTurnStartAt;\n          const compColor = playerColor === 'w' ? 'b' : 'w';\n          const compMs = compColor === 'w' ? clock.wMs : clock.bMs;\n          if (compMs - elapsed <= 0) {\n            finishOnTime(compColor);\n            return;\n          }\n        }\n      }\n\n      setIsThinking(true);\n      \n      return new Promise((resolve) => {\n        const stockfish = stockfishRef.current;\n        let bestMove = null;\n        let resolved = false;\n        \n        // Таймаут для Stockfish (максимум 5 секунд)\n        const timeout = setTimeout(() => {\n          if (!resolved) {\n            console.log('Stockfish timeout, используем простой алгоритм');\n            stockfish.removeEventListener('message', handleMessage);\n            makeSimpleComputerMove();\n            resolve();\n          }\n        }, 5000);\n        \n        const handleMessage = (event) => {\n          const message = event.data || event;\n          \n          if (message.includes('bestmove')) {\n            if (resolved) return;\n            resolved = true;\n            clearTimeout(timeout);\n            \n            const parts = message.split(' ');\n            if (parts.length >= 2) {\n              bestMove = parts[1];\n            }\n            \n            stockfish.removeEventListener('message', handleMessage);\n            \n            if (bestMove && bestMove !== 'null') {\n              try {\n                const move = game.move(bestMove);\n                if (move) {\n                  setMovesSan(prev => [...prev, move.san]);\n                  setGame(new Chess(game.fen()));\n                  const compColor = move.color;\n                  if (!settleTimeAfterMove(compColor)) {\n                    setIsThinking(false);\n                    resolve();\n                    return;\n                  }\n\n                  if (game.isGameOver()) {\n                    setIsGameOver(true);\n                    if (game.isCheckmate()) {\n                      setResult(playerColor === 'w' ? 'Победа чёрных!' : 'Победа белых!');\n                    } else if (game.isDraw()) {\n                      setResult('Ничья!');\n                    }\n                  }\n                }\n              } catch (error) {\n                console.error('Ошибка выполнения хода:', error);\n              }\n            }\n            \n            setIsThinking(false);\n            resolve();\n          }\n        };\n        \n        stockfish.addEventListener('message', handleMessage);\n        \n        // Настройка сложности через UCI параметры (оптимизировано для скорости)\n        const depth = difficulty >= 9 ? 8 : difficulty >= 7 ? 6 : difficulty >= 4 ? 4 : 2;\n        const skillLevel = Math.min(20, difficulty * 2);\n        const timeLimit = difficulty >= 7 ? 2000 : difficulty >= 4 ? 1000 : 500; // лимит времени в мс\n        \n        stockfish.postMessage('setoption name Skill Level value ' + skillLevel);\n        stockfish.postMessage('setoption name Threads value 1'); // один поток для скорости\n        stockfish.postMessage('setoption name Hash value 16'); // меньше памяти\n        stockfish.postMessage('position fen ' + game.fen());\n        stockfish.postMessage('go depth ' + depth + ' movetime ' + timeLimit);\n      });\n    } catch (error) {\n      console.error('Ошибка в makeComputerMove:', error);\n      setIsThinking(false);\n    }\n  };\n\n  const handleMove = async (sourceSquare, targetSquare) => {\n    try {\n      if (isGameOver || isThinking) return false;\n      if (game.turn() !== playerColor) return false;\n\n      const move = game.move({ from: sourceSquare, to: targetSquare });\n      if (!move) return false;\n\n      setMovesSan(prev => [...prev, move.san]);\n      setGame(new Chess(game.fen()));\n\n      if (!settleTimeAfterMove(move.color)) return true;\n\n      if (game.isGameOver()) {\n        setIsGameOver(true);\n        if (game.isCheckmate()) {\n          setResult(playerColor === 'w' ? 'Победа белых!' : 'Победа чёрных!');\n        } else if (game.isDraw()) {\n          setResult('Ничья!');\n        }\n        return true;\n      }\n\n      setTimeout(() => { makeComputerMove(); }, 200);\n      return true;\n    } catch (error) {\n      // Просто возвращаем false, фигура вернется на место\n      console.log('Неправильный ход:', error.message);\n      return false;\n    }\n  };\n\n  const changeDifficulty = (newDifficulty) => {\n    setDifficulty(newDifficulty);\n    startNewGame();\n  };\n\n  const changePlayerColor = (color) => {\n    setPlayerColor(color);\n    startNewGame();\n  };\n\n  const rows = useMemo(() => pairMoves(movesSan), [movesSan]);\n\n  return (\n    <div className=\"section\">\n      <button \n        onClick={() => navigate('/')}\n        className=\"button\"\n        style={{ marginBottom: 12 }}\n      >\n        Назад\n      </button>\n      \n      <h2>Игра против компьютера</h2>\n\n      {isLoadingStockfish && (\n        <div className=\"panel\" style={{ marginBottom: 16, color: '#8ab4f8' }}>\n          Загрузка легкой версии Stockfish...\n        </div>\n      )}\n\n      {!isStockfishReady && !isLoadingStockfish && (\n        <div className=\"panel\" style={{ marginBottom: 16, color: '#ffa726' }}>\n          ⚠️ Stockfish не загружен. Используется упрощенный ИИ.\n          <br />\n          <small>Игра будет работать, но компьютер будет играть проще.</small>\n          <br />\n          <small>Откройте консоль браузера (F12) для диагностики.</small>\n        </div>\n      )}\n\n      <div className=\"game-layout\">\n        <div className=\"game-board\">\n          <div style={{ display: 'flex', justifyContent: 'center', gap: 16, marginBottom: 16, flexWrap: 'wrap' }}>\n            <div className=\"panel\">\n              <label style={{ display: 'block', marginBottom: 6, fontWeight: 'bold' }}>\n                Сложность: {difficulty}/10\n              </label>\n              <input\n                type=\"range\"\n                min=\"1\"\n                max=\"10\"\n                value={difficulty}\n                onChange={(e) => changeDifficulty(parseInt(e.target.value))}\n                style={{ width: 180 }}\n              />\n            </div>\n            \n            <div className=\"panel\">\n              <label style={{ display: 'block', marginBottom: 6, fontWeight: 'bold' }}>\n                Цвет фигур:\n              </label>\n              <div style={{ display: 'flex', gap: 8 }}>\n                <button\n                  onClick={() => changePlayerColor('w')}\n                  className={`button ${playerColor === 'w' ? 'primary' : ''}`}\n                >\n                  Белые\n                </button>\n                <button\n                  onClick={() => changePlayerColor('b')}\n                  className={`button ${playerColor === 'b' ? 'primary' : ''}`}\n                >\n                  Чёрные\n                </button>\n              </div>\n            </div>\n\n            <div className=\"panel\">\n              <label style={{ display: 'block', marginBottom: 6, fontWeight: 'bold' }}>Контроль времени</label>\n              <div style={{ display: 'flex', gap: 8, alignItems: 'center' }}>\n                <input type=\"number\" min={1} max={180} value={minutes}\n                  onChange={(e) => { setMinutes(Number(e.target.value)); resetClocks(Number(e.target.value), increment); }}\n                  style={{ width: 80, padding: '8px', borderRadius: 6, border: '1px solid #3a3a3a', background: '#2a2a2a', color: '#e6e6e6' }} />\n                <span className=\"kicker\">+</span>\n                <input type=\"number\" min={0} max={60} value={increment}\n                  onChange={(e) => { setIncrement(Number(e.target.value)); }}\n                  style={{ width: 100, padding: '8px', borderRadius: 6, border: '1px solid #3a3a3a', background: '#2a2a2a', color: '#e6e6e6' }} />\n                <span className=\"kicker\">сек</span>\n              </div>\n            </div>\n          </div>\n          \n          <button onClick={startNewGame} className=\"button\" style={{ marginBottom: 12 }}>\n            Новая игра\n          </button>\n          \n          <div className=\"board-responsive\">\n            <Chessboard\n              position={game.fen()}\n              onPieceDrop={handleMove}\n              boardWidth={650}\n              boardOrientation={playerColor === 'w' ? 'white' : 'black'}\n            />\n          </div>\n\n          {isGameOver && (\n            <div className=\"panel\" style={{ marginTop: 12, color: '#ff8a80', fontWeight: 'bold' }}>\n              {result}\n            </div>\n          )}\n          \n          {isThinking && (\n            <div className=\"panel\" style={{ marginTop: 12, color: '#8ab4f8' }}>\n              Компьютер анализирует позицию…\n            </div>\n          )}\n        </div>\n\n        <div className=\"game-sidebar\">\n          <div className=\"panel game-clock\">\n            <h3 style={{ marginTop: 0 }}>Часы</h3>\n            <div style={{ display: 'flex', flexDirection: 'column', gap: 8 }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                <span>Белые</span>\n                <strong>{formatMs(displayedClock.wMs)}</strong>\n              </div>\n              <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                <span>Чёрные</span>\n                <strong>{formatMs(displayedClock.bMs)}</strong>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"panel game-history\">\n            <h3 style={{ marginTop: 0 }}>История ходов</h3>\n            {rows.length === 0 ? (\n              <p className=\"kicker\">Пока нет ходов</p>\n            ) : (\n              <table style={{ width: '100%', borderCollapse: 'collapse' }}>\n                <thead>\n                  <tr>\n                    <th style={{ textAlign: 'left', width: 40 }}>#</th>\n                    <th style={{ textAlign: 'left' }}>Белые</th>\n                    <th style={{ textAlign: 'left' }}>Чёрные</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {rows.map((r) => (\n                    <tr key={r.no}>\n                      <td>{r.no}.</td>\n                      <td>{r.w}</td>\n                      <td>{r.b}</td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ComputerGame;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,OAAO,CAAEC,MAAM,KAAQ,OAAO,CACnE,OAASC,UAAU,KAAQ,kBAAkB,CAC7C,OAASC,KAAK,KAAQ,UAAU,CAChC,OAASC,WAAW,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE/C,KAAM,CAAAC,QAAQ,CAAIC,EAAE,EAAK,CACvB,KAAM,CAAAC,CAAC,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAED,IAAI,CAACE,KAAK,CAACJ,EAAE,CAAG,IAAI,CAAC,CAAC,CAC5C,KAAM,CAAAK,CAAC,CAAGH,IAAI,CAACE,KAAK,CAACH,CAAC,CAAG,EAAE,CAAC,CAC5B,KAAM,CAAAK,GAAG,CAAGL,CAAC,CAAG,EAAE,CAClB,SAAAM,MAAA,CAAUF,CAAC,MAAAE,MAAA,CAAID,GAAG,CAACE,QAAQ,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,EAChD,CAAC,CAED,KAAM,CAAAC,SAAS,CAAIC,IAAI,EAAK,CAC1B,KAAM,CAAAC,IAAI,CAAG,EAAE,CACf,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGF,IAAI,CAACG,MAAM,CAAED,CAAC,EAAI,CAAC,CAAE,CACvCD,IAAI,CAACG,IAAI,CAAC,CAAEC,EAAE,CAAEd,IAAI,CAACE,KAAK,CAACS,CAAC,CAAG,CAAC,CAAC,CAAG,CAAC,CAAEI,CAAC,CAAEN,IAAI,CAACE,CAAC,CAAC,EAAI,EAAE,CAAEK,CAAC,CAAEP,IAAI,CAACE,CAAC,CAAG,CAAC,CAAC,EAAI,EAAG,CAAC,CAAC,CAClF,CACA,MAAO,CAAAD,IAAI,CACb,CAAC,CAED,KAAM,CAAAO,YAAY,CAAGA,CAAA,GAAM,CACzB,KAAM,CAAAC,QAAQ,CAAG1B,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAC2B,IAAI,CAAEC,OAAO,CAAC,CAAGlC,QAAQ,CAAC,GAAI,CAAAK,KAAK,CAAC,CAAC,CAAC,CAC7C,KAAM,CAAC8B,UAAU,CAAEC,aAAa,CAAC,CAAGpC,QAAQ,CAAC,CAAC,CAAC,CAC/C,KAAM,CAACqC,UAAU,CAAEC,aAAa,CAAC,CAAGtC,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAACuC,MAAM,CAAEC,SAAS,CAAC,CAAGxC,QAAQ,CAAC,IAAI,CAAC,CAC1C,KAAM,CAACyC,UAAU,CAAEC,aAAa,CAAC,CAAG1C,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAAC2C,WAAW,CAAEC,cAAc,CAAC,CAAG5C,QAAQ,CAAC,GAAG,CAAC,CAAE;AACrD,KAAM,CAAC6C,gBAAgB,CAAEC,mBAAmB,CAAC,CAAG9C,QAAQ,CAAC,KAAK,CAAC,CAC/D,KAAM,CAAC+C,kBAAkB,CAAEC,qBAAqB,CAAC,CAAGhD,QAAQ,CAAC,IAAI,CAAC,CAClE,KAAM,CAAAiD,YAAY,CAAG9C,MAAM,CAAC,IAAI,CAAC,CAEjC;AACA,KAAM,CAAC+C,OAAO,CAAEC,UAAU,CAAC,CAAGnD,QAAQ,CAAC,CAAC,CAAC,CACzC,KAAM,CAACoD,SAAS,CAAEC,YAAY,CAAC,CAAGrD,QAAQ,CAAC,CAAC,CAAC,CAC7C,KAAM,CAACsD,KAAK,CAAEC,QAAQ,CAAC,CAAGvD,QAAQ,CAAC,CAAEwD,GAAG,CAAEN,OAAO,CAAG,KAAK,CAAEO,GAAG,CAAEP,OAAO,CAAG,KAAM,CAAC,CAAC,CAClF,KAAM,CAACQ,eAAe,CAAEC,kBAAkB,CAAC,CAAG3D,QAAQ,CAAC,IAAI,CAAC,CAC5D,KAAM,CAAC4D,IAAI,CAAEC,OAAO,CAAC,CAAG7D,QAAQ,CAAC,CAAC,CAAC,CAEnC;AACA,KAAM,CAAC8D,QAAQ,CAAEC,WAAW,CAAC,CAAG/D,QAAQ,CAAC,EAAE,CAAC,CAE5C;AACAC,SAAS,CAAC,IAAM,CACd,KAAM,CAAA+D,aAAa,CAAG,KAAAA,CAAA,GAAY,CAChC,GAAI,CACFhB,qBAAqB,CAAC,IAAI,CAAC,CAE3B;AACA,GAAI,CAACiB,MAAM,CAACC,SAAS,CAAE,CACrB,KAAM,CAAAC,MAAM,CAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC,CAE/C;AACA,KAAM,CAAAC,aAAa,CAAGA,CAAA,GAAM,CAC1BH,MAAM,CAACI,GAAG,CAAG,8BAA8B,CAC3CC,OAAO,CAACC,GAAG,CAAC,0CAA0C,CAAC,CACzD,CAAC,CAED,KAAM,CAAAC,MAAM,CAAGA,CAAA,GAAM,CACnBP,MAAM,CAACI,GAAG,CAAG,oEAAoE,CACjFC,OAAO,CAACC,GAAG,CAAC,sCAAsC,CAAC,CACrD,CAAC,CAED,GAAI,CAAAE,OAAO,CAAG,CAAC,CACf,KAAM,CAAAC,WAAW,CAAG,CAAC,CAErB,KAAM,CAAAC,UAAU,CAAGA,CAAA,GAAM,CACvB,GAAIF,OAAO,GAAK,CAAC,CAAE,CACjBL,aAAa,CAAC,CAAC,CACjB,CAAC,IAAM,IAAIK,OAAO,GAAK,CAAC,CAAE,CACxBD,MAAM,CAAC,CAAC,CACV,CAAC,IAAM,CACLF,OAAO,CAACC,GAAG,CAAC,iEAAiE,CAAC,CAC9EzB,qBAAqB,CAAC,KAAK,CAAC,CAC5B,OACF,CACA2B,OAAO,EAAE,CACX,CAAC,CAED;AACA,KAAM,CAAAG,aAAa,CAAGC,UAAU,CAAC,IAAM,CACrCP,OAAO,CAACC,GAAG,CAAC,uDAAuD,CAAC,CACpEzB,qBAAqB,CAAC,KAAK,CAAC,CAC9B,CAAC,CAAE,KAAK,CAAC,CAETmB,MAAM,CAACa,MAAM,CAAG,IAAM,CACpBC,YAAY,CAACH,aAAa,CAAC,CAC3B,GAAI,CACF;AACAC,UAAU,CAAC,IAAM,CACf,GAAId,MAAM,CAACC,SAAS,EAAI,MAAO,CAAAD,MAAM,CAACC,SAAS,GAAK,UAAU,CAAE,CAC9D,GAAI,CACF,KAAM,CAAAgB,SAAS,CAAG,GAAI,CAAAjB,MAAM,CAACC,SAAS,CAAC,CAAC,CACxCjB,YAAY,CAACkC,OAAO,CAAGD,SAAS,CAEhCA,SAAS,CAACE,SAAS,CAAIC,KAAK,EAAK,CAC/B,KAAM,CAAAC,OAAO,CAAGD,KAAK,CAACE,IAAI,EAAIF,KAAK,CACnCb,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAEa,OAAO,CAAC,CAC1C,GAAIA,OAAO,CAACE,QAAQ,CAAC,OAAO,CAAC,CAAE,CAC7B1C,mBAAmB,CAAC,IAAI,CAAC,CACzBE,qBAAqB,CAAC,KAAK,CAAC,CAC9B,CACF,CAAC,CAEDkC,SAAS,CAACO,WAAW,CAAC,KAAK,CAAC,CAC9B,CAAE,MAAOC,KAAK,CAAE,CACdlB,OAAO,CAACkB,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CAClD1C,qBAAqB,CAAC,KAAK,CAAC,CAC9B,CACF,CAAC,IAAM,CACLwB,OAAO,CAACkB,KAAK,CAAC,8BAA8B,CAAC,CAC7C1C,qBAAqB,CAAC,KAAK,CAAC,CAC9B,CACF,CAAC,CAAE,GAAG,CAAC,CACT,CAAE,MAAO0C,KAAK,CAAE,CACdlB,OAAO,CAACkB,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CAClD1C,qBAAqB,CAAC,KAAK,CAAC,CAC9B,CACF,CAAC,CAEDmB,MAAM,CAACwB,OAAO,CAAG,IAAM,CACrBnB,OAAO,CAACkB,KAAK,gJAAAvE,MAAA,CAAuCwD,OAAO,KAAG,CAAC,CAC/D,GAAIA,OAAO,CAAGC,WAAW,CAAE,CACzBC,UAAU,CAAC,CAAC,CACd,CAAC,IAAM,CACLI,YAAY,CAACH,aAAa,CAAC,CAC3B9B,qBAAqB,CAAC,KAAK,CAAC,CAC9B,CACF,CAAC,CAED6B,UAAU,CAAC,CAAC,CACZT,QAAQ,CAACwB,IAAI,CAACC,WAAW,CAAC1B,MAAM,CAAC,CACnC,CAAC,IAAM,CACL,GAAI,CACF,KAAM,CAAAe,SAAS,CAAG,GAAI,CAAAjB,MAAM,CAACC,SAAS,CAAC,CAAC,CACxCjB,YAAY,CAACkC,OAAO,CAAGD,SAAS,CAEhCA,SAAS,CAACE,SAAS,CAAIC,KAAK,EAAK,CAC/B,KAAM,CAAAC,OAAO,CAAGD,KAAK,CAACE,IAAI,EAAIF,KAAK,CACnCb,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAEa,OAAO,CAAC,CAC1C,GAAIA,OAAO,CAACE,QAAQ,CAAC,OAAO,CAAC,CAAE,CAC7B1C,mBAAmB,CAAC,IAAI,CAAC,CACzBE,qBAAqB,CAAC,KAAK,CAAC,CAC9B,CACF,CAAC,CAEDkC,SAAS,CAACO,WAAW,CAAC,KAAK,CAAC,CAC9B,CAAE,MAAOC,KAAK,CAAE,CACdlB,OAAO,CAACkB,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CAClD1C,qBAAqB,CAAC,KAAK,CAAC,CAC9B,CACF,CACF,CAAE,MAAO0C,KAAK,CAAE,CACdlB,OAAO,CAACkB,KAAK,CAAC,iCAAiC,CAAEA,KAAK,CAAC,CACvD1C,qBAAqB,CAAC,KAAK,CAAC,CAC9B,CACF,CAAC,CAEDgB,aAAa,CAAC,CAAC,CAEf,MAAO,IAAM,CACX,GAAIf,YAAY,CAACkC,OAAO,CAAE,CACxBlC,YAAY,CAACkC,OAAO,CAACW,SAAS,CAAC,CAAC,CAClC,CACF,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN7F,SAAS,CAAC,IAAM,CACd,GAAI4C,gBAAgB,CAAE,CACpBkD,YAAY,CAAC,CAAC,CAChB,CACF,CAAC,CAAE,CAAClD,gBAAgB,CAAC,CAAC,CAEtB5C,SAAS,CAAC,IAAM,CACd,GAAI,CAACoC,UAAU,EAAIM,WAAW,GAAK,GAAG,EAAIV,IAAI,CAAC+D,IAAI,CAAC,CAAC,GAAK,GAAG,CAAE,CAC7DC,gBAAgB,CAAC,CAAC,CACpB,CACF,CAAC,CAAE,CAACtD,WAAW,CAAC,CAAC,CAEjB1C,SAAS,CAAC,IAAM,CACd,KAAM,CAAAiG,EAAE,CAAGC,WAAW,CAAC,IAAMtC,OAAO,CAAEuC,CAAC,EAAKA,CAAC,CAAG,CAAC,CAAC,CAAE,GAAG,CAAC,CACxD,MAAO,IAAMC,aAAa,CAACH,EAAE,CAAC,CAChC,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAI,cAAc,CAAGpG,OAAO,CAAC,IAAM,CACnC,GAAImC,UAAU,EAAIqB,eAAe,EAAI,IAAI,CAAE,MAAO,CAAAJ,KAAK,CACvD,KAAM,CAAAiD,GAAG,CAAGC,IAAI,CAACD,GAAG,CAAC,CAAC,CACtB,KAAM,CAAAE,OAAO,CAAG3F,IAAI,CAACC,GAAG,CAAC,CAAC,CAAEwF,GAAG,CAAG7C,eAAe,CAAC,CAClD,GAAIzB,IAAI,CAAC+D,IAAI,CAAC,CAAC,GAAK,GAAG,CAAE,CACvB,MAAO,CAAExC,GAAG,CAAE1C,IAAI,CAACC,GAAG,CAAC,CAAC,CAAEuC,KAAK,CAACE,GAAG,CAAGiD,OAAO,CAAC,CAAEhD,GAAG,CAAEH,KAAK,CAACG,GAAI,CAAC,CAClE,CAAC,IAAM,CACL,MAAO,CAAED,GAAG,CAAEF,KAAK,CAACE,GAAG,CAAEC,GAAG,CAAE3C,IAAI,CAACC,GAAG,CAAC,CAAC,CAAEuC,KAAK,CAACG,GAAG,CAAGgD,OAAO,CAAE,CAAC,CAClE,CACF,CAAC,CAAE,CAACnD,KAAK,CAAEI,eAAe,CAAErB,UAAU,CAAEJ,IAAI,CAAE2B,IAAI,CAAC,CAAC,CAEpD,KAAM,CAAA8C,WAAW,CAAGA,CAACC,IAAI,CAAEC,GAAG,GAAK,CACjC,KAAM,CAAAhG,EAAE,CAAG+F,IAAI,CAAG,KAAK,CACvBpD,QAAQ,CAAC,CAAEC,GAAG,CAAE5C,EAAE,CAAE6C,GAAG,CAAE7C,EAAG,CAAC,CAAC,CAC9B+C,kBAAkB,CAAC6C,IAAI,CAACD,GAAG,CAAC,CAAC,CAAC,CAChC,CAAC,CAED,KAAM,CAAAR,YAAY,CAAGA,CAAA,GAAM,CACzB,KAAM,CAAAc,OAAO,CAAG,GAAI,CAAAxG,KAAK,CAAC,CAAC,CAC3B6B,OAAO,CAAC2E,OAAO,CAAC,CAChBvE,aAAa,CAAC,KAAK,CAAC,CACpBE,SAAS,CAAC,IAAI,CAAC,CACfE,aAAa,CAAC,KAAK,CAAC,CACpBqB,WAAW,CAAC,EAAE,CAAC,CACf2C,WAAW,CAACxD,OAAO,CAAEE,SAAS,CAAC,CAC/B,GAAIT,WAAW,GAAK,GAAG,CAAE,CACvBoC,UAAU,CAAC,IAAMkB,gBAAgB,CAAC,CAAC,CAAE,EAAE,CAAC,CAC1C,CACF,CAAC,CAED,KAAM,CAAAa,YAAY,CAAIC,KAAK,EAAK,CAC9BzE,aAAa,CAAC,IAAI,CAAC,CACnBE,SAAS,CAACuE,KAAK,GAAK,GAAG,CAAG,8BAA8B,CAAG,+BAA+B,CAAC,CAC7F,CAAC,CAED,KAAM,CAAAC,mBAAmB,CAAIC,UAAU,EAAK,CAC1C,KAAM,CAAAV,GAAG,CAAGC,IAAI,CAACD,GAAG,CAAC,CAAC,CACtB,GAAI7C,eAAe,EAAI,IAAI,CAAE,CAC3B,KAAM,CAAA+C,OAAO,CAAGF,GAAG,CAAG7C,eAAe,CACrC,GAAIuD,UAAU,GAAK,GAAG,CAAE,CACtB,KAAM,CAAAC,IAAI,CAAGpG,IAAI,CAACC,GAAG,CAAC,CAAC,CAAEuC,KAAK,CAACE,GAAG,CAAGiD,OAAO,CAAC,CAAGrD,SAAS,CAAG,IAAI,CAChE,GAAI8D,IAAI,EAAI,CAAC,CAAE,CAAEJ,YAAY,CAAC,GAAG,CAAC,CAAE,MAAO,MAAK,CAAE,CAClDvD,QAAQ,CAAC,CAAEC,GAAG,CAAE0D,IAAI,CAAEzD,GAAG,CAAEH,KAAK,CAACG,GAAI,CAAC,CAAC,CACzC,CAAC,IAAM,CACL,KAAM,CAAA0D,IAAI,CAAGrG,IAAI,CAACC,GAAG,CAAC,CAAC,CAAEuC,KAAK,CAACG,GAAG,CAAGgD,OAAO,CAAC,CAAGrD,SAAS,CAAG,IAAI,CAChE,GAAI+D,IAAI,EAAI,CAAC,CAAE,CAAEL,YAAY,CAAC,GAAG,CAAC,CAAE,MAAO,MAAK,CAAE,CAClDvD,QAAQ,CAAC,CAAEC,GAAG,CAAEF,KAAK,CAACE,GAAG,CAAEC,GAAG,CAAE0D,IAAK,CAAC,CAAC,CACzC,CACF,CACAxD,kBAAkB,CAAC4C,GAAG,CAAC,CACvB,MAAO,KAAI,CACb,CAAC,CAED,KAAM,CAAAa,sBAAsB,CAAGA,CAAA,GAAM,CACnC,GAAI/E,UAAU,EAAIJ,IAAI,CAACI,UAAU,CAAC,CAAC,CAAE,OAErCK,aAAa,CAAC,IAAI,CAAC,CAEnBqC,UAAU,CAAC,IAAM,CACf,GAAI,CACF,KAAM,CAAAsC,KAAK,CAAGpF,IAAI,CAACoF,KAAK,CAAC,CAAC,CAC1B,GAAIA,KAAK,CAAC3F,MAAM,CAAG,CAAC,CAAE,CACpB;AACA,KAAM,CAAA4F,QAAQ,CAAGD,KAAK,CAACE,MAAM,CAACC,IAAI,EAAI,CACpC,KAAM,CAAAC,QAAQ,CAAG,GAAI,CAAApH,KAAK,CAAC4B,IAAI,CAACyF,GAAG,CAAC,CAAC,CAAC,CACtC,KAAM,CAAAC,OAAO,CAAGF,QAAQ,CAACD,IAAI,CAACA,IAAI,CAAC,CACnC,MAAO,CAAAG,OAAO,EAAIA,OAAO,CAACC,QAAQ,CACpC,CAAC,CAAC,CAEF,KAAM,CAAAC,UAAU,CAAGP,QAAQ,CAAC5F,MAAM,CAAG,CAAC,EAAIZ,IAAI,CAACgH,MAAM,CAAC,CAAC,CAAG,GAAG,CACzDR,QAAQ,CAACxG,IAAI,CAACE,KAAK,CAACF,IAAI,CAACgH,MAAM,CAAC,CAAC,CAAGR,QAAQ,CAAC5F,MAAM,CAAC,CAAC,CACrD2F,KAAK,CAACvG,IAAI,CAACE,KAAK,CAACF,IAAI,CAACgH,MAAM,CAAC,CAAC,CAAGT,KAAK,CAAC3F,MAAM,CAAC,CAAC,CAEnD,KAAM,CAAA8F,IAAI,CAAGvF,IAAI,CAACuF,IAAI,CAACK,UAAU,CAAC,CAClC,GAAIL,IAAI,CAAE,CACRzD,WAAW,CAACgE,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAEP,IAAI,CAACQ,GAAG,CAAC,CAAC,CACxC9F,OAAO,CAAC,GAAI,CAAA7B,KAAK,CAAC4B,IAAI,CAACyF,GAAG,CAAC,CAAC,CAAC,CAAC,CAC9B,KAAM,CAAAO,SAAS,CAAGT,IAAI,CAACU,KAAK,CAC5B,GAAI,CAAClB,mBAAmB,CAACiB,SAAS,CAAC,CAAE,CACnCvF,aAAa,CAAC,KAAK,CAAC,CACpB,OACF,CAEA,GAAIT,IAAI,CAACI,UAAU,CAAC,CAAC,CAAE,CACrBC,aAAa,CAAC,IAAI,CAAC,CACnB,GAAIL,IAAI,CAACkG,WAAW,CAAC,CAAC,CAAE,CACtB3F,SAAS,CAACG,WAAW,GAAK,GAAG,CAAG,gBAAgB,CAAG,eAAe,CAAC,CACrE,CAAC,IAAM,IAAIV,IAAI,CAACmG,MAAM,CAAC,CAAC,CAAE,CACxB5F,SAAS,CAAC,QAAQ,CAAC,CACrB,CACF,CACF,CACF,CACF,CAAE,MAAOkD,KAAK,CAAE,CACdlB,OAAO,CAACkB,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC/C,CAAC,OAAS,CACRhD,aAAa,CAAC,KAAK,CAAC,CACtB,CACF,CAAC,CAAE,GAAG,CAAG5B,IAAI,CAACgH,MAAM,CAAC,CAAC,CAAG,IAAI,CAAC,CAAE;AAClC,CAAC,CAED,KAAM,CAAA7B,gBAAgB,CAAG,KAAAA,CAAA,GAAY,CACnC,GAAI,CACF,GAAI5D,UAAU,EAAIJ,IAAI,CAACI,UAAU,CAAC,CAAC,CAAE,OAErC;AACA,GAAI,CAACQ,gBAAgB,EAAI,CAACI,YAAY,CAACkC,OAAO,CAAE,CAC9CiC,sBAAsB,CAAC,CAAC,CACxB,OACF,CAEA,GAAInF,IAAI,CAAC+D,IAAI,CAAC,CAAC,GAAKrD,WAAW,CAAE,CAC/B,KAAM,CAAA4D,GAAG,CAAGC,IAAI,CAACD,GAAG,CAAC,CAAC,CACtB,GAAI7C,eAAe,EAAI,IAAI,CAAE,CAC3B,KAAM,CAAA+C,OAAO,CAAGF,GAAG,CAAG7C,eAAe,CACrC,KAAM,CAAAuE,SAAS,CAAGtF,WAAW,GAAK,GAAG,CAAG,GAAG,CAAG,GAAG,CACjD,KAAM,CAAA0F,MAAM,CAAGJ,SAAS,GAAK,GAAG,CAAG3E,KAAK,CAACE,GAAG,CAAGF,KAAK,CAACG,GAAG,CACxD,GAAI4E,MAAM,CAAG5B,OAAO,EAAI,CAAC,CAAE,CACzBK,YAAY,CAACmB,SAAS,CAAC,CACvB,OACF,CACF,CACF,CAEAvF,aAAa,CAAC,IAAI,CAAC,CAEnB,MAAO,IAAI,CAAA4F,OAAO,CAAEC,OAAO,EAAK,CAC9B,KAAM,CAAArD,SAAS,CAAGjC,YAAY,CAACkC,OAAO,CACtC,GAAI,CAAAqD,QAAQ,CAAG,IAAI,CACnB,GAAI,CAAAC,QAAQ,CAAG,KAAK,CAEpB;AACA,KAAM,CAAAC,OAAO,CAAG3D,UAAU,CAAC,IAAM,CAC/B,GAAI,CAAC0D,QAAQ,CAAE,CACbjE,OAAO,CAACC,GAAG,CAAC,gDAAgD,CAAC,CAC7DS,SAAS,CAACyD,mBAAmB,CAAC,SAAS,CAAEC,aAAa,CAAC,CACvDxB,sBAAsB,CAAC,CAAC,CACxBmB,OAAO,CAAC,CAAC,CACX,CACF,CAAC,CAAE,IAAI,CAAC,CAER,KAAM,CAAAK,aAAa,CAAIvD,KAAK,EAAK,CAC/B,KAAM,CAAAC,OAAO,CAAGD,KAAK,CAACE,IAAI,EAAIF,KAAK,CAEnC,GAAIC,OAAO,CAACE,QAAQ,CAAC,UAAU,CAAC,CAAE,CAChC,GAAIiD,QAAQ,CAAE,OACdA,QAAQ,CAAG,IAAI,CACfxD,YAAY,CAACyD,OAAO,CAAC,CAErB,KAAM,CAAAG,KAAK,CAAGvD,OAAO,CAACwD,KAAK,CAAC,GAAG,CAAC,CAChC,GAAID,KAAK,CAACnH,MAAM,EAAI,CAAC,CAAE,CACrB8G,QAAQ,CAAGK,KAAK,CAAC,CAAC,CAAC,CACrB,CAEA3D,SAAS,CAACyD,mBAAmB,CAAC,SAAS,CAAEC,aAAa,CAAC,CAEvD,GAAIJ,QAAQ,EAAIA,QAAQ,GAAK,MAAM,CAAE,CACnC,GAAI,CACF,KAAM,CAAAhB,IAAI,CAAGvF,IAAI,CAACuF,IAAI,CAACgB,QAAQ,CAAC,CAChC,GAAIhB,IAAI,CAAE,CACRzD,WAAW,CAACgE,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAEP,IAAI,CAACQ,GAAG,CAAC,CAAC,CACxC9F,OAAO,CAAC,GAAI,CAAA7B,KAAK,CAAC4B,IAAI,CAACyF,GAAG,CAAC,CAAC,CAAC,CAAC,CAC9B,KAAM,CAAAO,SAAS,CAAGT,IAAI,CAACU,KAAK,CAC5B,GAAI,CAAClB,mBAAmB,CAACiB,SAAS,CAAC,CAAE,CACnCvF,aAAa,CAAC,KAAK,CAAC,CACpB6F,OAAO,CAAC,CAAC,CACT,OACF,CAEA,GAAItG,IAAI,CAACI,UAAU,CAAC,CAAC,CAAE,CACrBC,aAAa,CAAC,IAAI,CAAC,CACnB,GAAIL,IAAI,CAACkG,WAAW,CAAC,CAAC,CAAE,CACtB3F,SAAS,CAACG,WAAW,GAAK,GAAG,CAAG,gBAAgB,CAAG,eAAe,CAAC,CACrE,CAAC,IAAM,IAAIV,IAAI,CAACmG,MAAM,CAAC,CAAC,CAAE,CACxB5F,SAAS,CAAC,QAAQ,CAAC,CACrB,CACF,CACF,CACF,CAAE,MAAOkD,KAAK,CAAE,CACdlB,OAAO,CAACkB,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CACjD,CACF,CAEAhD,aAAa,CAAC,KAAK,CAAC,CACpB6F,OAAO,CAAC,CAAC,CACX,CACF,CAAC,CAEDrD,SAAS,CAAC6D,gBAAgB,CAAC,SAAS,CAAEH,aAAa,CAAC,CAEpD;AACA,KAAM,CAAAI,KAAK,CAAG7G,UAAU,EAAI,CAAC,CAAG,CAAC,CAAGA,UAAU,EAAI,CAAC,CAAG,CAAC,CAAGA,UAAU,EAAI,CAAC,CAAG,CAAC,CAAG,CAAC,CACjF,KAAM,CAAA8G,UAAU,CAAGnI,IAAI,CAACoI,GAAG,CAAC,EAAE,CAAE/G,UAAU,CAAG,CAAC,CAAC,CAC/C,KAAM,CAAAgH,SAAS,CAAGhH,UAAU,EAAI,CAAC,CAAG,IAAI,CAAGA,UAAU,EAAI,CAAC,CAAG,IAAI,CAAG,GAAG,CAAE;AAEzE+C,SAAS,CAACO,WAAW,CAAC,mCAAmC,CAAGwD,UAAU,CAAC,CACvE/D,SAAS,CAACO,WAAW,CAAC,gCAAgC,CAAC,CAAE;AACzDP,SAAS,CAACO,WAAW,CAAC,8BAA8B,CAAC,CAAE;AACvDP,SAAS,CAACO,WAAW,CAAC,eAAe,CAAGxD,IAAI,CAACyF,GAAG,CAAC,CAAC,CAAC,CACnDxC,SAAS,CAACO,WAAW,CAAC,WAAW,CAAGuD,KAAK,CAAG,YAAY,CAAGG,SAAS,CAAC,CACvE,CAAC,CAAC,CACJ,CAAE,MAAOzD,KAAK,CAAE,CACdlB,OAAO,CAACkB,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CAClDhD,aAAa,CAAC,KAAK,CAAC,CACtB,CACF,CAAC,CAED,KAAM,CAAA0G,UAAU,CAAG,KAAAA,CAAOC,YAAY,CAAEC,YAAY,GAAK,CACvD,GAAI,CACF,GAAIjH,UAAU,EAAII,UAAU,CAAE,MAAO,MAAK,CAC1C,GAAIR,IAAI,CAAC+D,IAAI,CAAC,CAAC,GAAKrD,WAAW,CAAE,MAAO,MAAK,CAE7C,KAAM,CAAA6E,IAAI,CAAGvF,IAAI,CAACuF,IAAI,CAAC,CAAE+B,IAAI,CAAEF,YAAY,CAAEG,EAAE,CAAEF,YAAa,CAAC,CAAC,CAChE,GAAI,CAAC9B,IAAI,CAAE,MAAO,MAAK,CAEvBzD,WAAW,CAACgE,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAEP,IAAI,CAACQ,GAAG,CAAC,CAAC,CACxC9F,OAAO,CAAC,GAAI,CAAA7B,KAAK,CAAC4B,IAAI,CAACyF,GAAG,CAAC,CAAC,CAAC,CAAC,CAE9B,GAAI,CAACV,mBAAmB,CAACQ,IAAI,CAACU,KAAK,CAAC,CAAE,MAAO,KAAI,CAEjD,GAAIjG,IAAI,CAACI,UAAU,CAAC,CAAC,CAAE,CACrBC,aAAa,CAAC,IAAI,CAAC,CACnB,GAAIL,IAAI,CAACkG,WAAW,CAAC,CAAC,CAAE,CACtB3F,SAAS,CAACG,WAAW,GAAK,GAAG,CAAG,eAAe,CAAG,gBAAgB,CAAC,CACrE,CAAC,IAAM,IAAIV,IAAI,CAACmG,MAAM,CAAC,CAAC,CAAE,CACxB5F,SAAS,CAAC,QAAQ,CAAC,CACrB,CACA,MAAO,KAAI,CACb,CAEAuC,UAAU,CAAC,IAAM,CAAEkB,gBAAgB,CAAC,CAAC,CAAE,CAAC,CAAE,GAAG,CAAC,CAC9C,MAAO,KAAI,CACb,CAAE,MAAOP,KAAK,CAAE,CACd;AACAlB,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAEiB,KAAK,CAACJ,OAAO,CAAC,CAC/C,MAAO,MAAK,CACd,CACF,CAAC,CAED,KAAM,CAAAmE,gBAAgB,CAAIC,aAAa,EAAK,CAC1CtH,aAAa,CAACsH,aAAa,CAAC,CAC5B3D,YAAY,CAAC,CAAC,CAChB,CAAC,CAED,KAAM,CAAA4D,iBAAiB,CAAIzB,KAAK,EAAK,CACnCtF,cAAc,CAACsF,KAAK,CAAC,CACrBnC,YAAY,CAAC,CAAC,CAChB,CAAC,CAED,KAAM,CAAAvE,IAAI,CAAGtB,OAAO,CAAC,IAAMoB,SAAS,CAACwC,QAAQ,CAAC,CAAE,CAACA,QAAQ,CAAC,CAAC,CAE3D,mBACEpD,KAAA,QAAKkJ,SAAS,CAAC,SAAS,CAAAC,QAAA,eACtBrJ,IAAA,WACEsJ,OAAO,CAAEA,CAAA,GAAM9H,QAAQ,CAAC,GAAG,CAAE,CAC7B4H,SAAS,CAAC,QAAQ,CAClBG,KAAK,CAAE,CAAEC,YAAY,CAAE,EAAG,CAAE,CAAAH,QAAA,CAC7B,gCAED,CAAQ,CAAC,cAETrJ,IAAA,OAAAqJ,QAAA,CAAI,4HAAsB,CAAI,CAAC,CAE9B9G,kBAAkB,eACjBvC,IAAA,QAAKoJ,SAAS,CAAC,OAAO,CAACG,KAAK,CAAE,CAAEC,YAAY,CAAE,EAAE,CAAE9B,KAAK,CAAE,SAAU,CAAE,CAAA2B,QAAA,CAAC,yIAEtE,CAAK,CACN,CAEA,CAAChH,gBAAgB,EAAI,CAACE,kBAAkB,eACvCrC,KAAA,QAAKkJ,SAAS,CAAC,OAAO,CAACG,KAAK,CAAE,CAAEC,YAAY,CAAE,EAAE,CAAE9B,KAAK,CAAE,SAAU,CAAE,CAAA2B,QAAA,EAAC,2OAEpE,cAAArJ,IAAA,QAAK,CAAC,cACNA,IAAA,UAAAqJ,QAAA,CAAO,mRAAqD,CAAO,CAAC,cACpErJ,IAAA,QAAK,CAAC,cACNA,IAAA,UAAAqJ,QAAA,CAAO,2OAAgD,CAAO,CAAC,EAC5D,CACN,cAEDnJ,KAAA,QAAKkJ,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BnJ,KAAA,QAAKkJ,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBnJ,KAAA,QAAKqJ,KAAK,CAAE,CAAEE,OAAO,CAAE,MAAM,CAAEC,cAAc,CAAE,QAAQ,CAAEC,GAAG,CAAE,EAAE,CAAEH,YAAY,CAAE,EAAE,CAAEI,QAAQ,CAAE,MAAO,CAAE,CAAAP,QAAA,eACrGnJ,KAAA,QAAKkJ,SAAS,CAAC,OAAO,CAAAC,QAAA,eACpBnJ,KAAA,UAAOqJ,KAAK,CAAE,CAAEE,OAAO,CAAE,OAAO,CAAED,YAAY,CAAE,CAAC,CAAEK,UAAU,CAAE,MAAO,CAAE,CAAAR,QAAA,EAAC,0DAC5D,CAAC1H,UAAU,CAAC,KACzB,EAAO,CAAC,cACR3B,IAAA,UACE8J,IAAI,CAAC,OAAO,CACZpB,GAAG,CAAC,GAAG,CACPnI,GAAG,CAAC,IAAI,CACRwJ,KAAK,CAAEpI,UAAW,CAClBqI,QAAQ,CAAGC,CAAC,EAAKhB,gBAAgB,CAACiB,QAAQ,CAACD,CAAC,CAACE,MAAM,CAACJ,KAAK,CAAC,CAAE,CAC5DR,KAAK,CAAE,CAAEa,KAAK,CAAE,GAAI,CAAE,CACvB,CAAC,EACC,CAAC,cAENlK,KAAA,QAAKkJ,SAAS,CAAC,OAAO,CAAAC,QAAA,eACpBrJ,IAAA,UAAOuJ,KAAK,CAAE,CAAEE,OAAO,CAAE,OAAO,CAAED,YAAY,CAAE,CAAC,CAAEK,UAAU,CAAE,MAAO,CAAE,CAAAR,QAAA,CAAC,0DAEzE,CAAO,CAAC,cACRnJ,KAAA,QAAKqJ,KAAK,CAAE,CAAEE,OAAO,CAAE,MAAM,CAAEE,GAAG,CAAE,CAAE,CAAE,CAAAN,QAAA,eACtCrJ,IAAA,WACEsJ,OAAO,CAAEA,CAAA,GAAMH,iBAAiB,CAAC,GAAG,CAAE,CACtCC,SAAS,WAAAzI,MAAA,CAAYwB,WAAW,GAAK,GAAG,CAAG,SAAS,CAAG,EAAE,CAAG,CAAAkH,QAAA,CAC7D,gCAED,CAAQ,CAAC,cACTrJ,IAAA,WACEsJ,OAAO,CAAEA,CAAA,GAAMH,iBAAiB,CAAC,GAAG,CAAE,CACtCC,SAAS,WAAAzI,MAAA,CAAYwB,WAAW,GAAK,GAAG,CAAG,SAAS,CAAG,EAAE,CAAG,CAAAkH,QAAA,CAC7D,sCAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,cAENnJ,KAAA,QAAKkJ,SAAS,CAAC,OAAO,CAAAC,QAAA,eACpBrJ,IAAA,UAAOuJ,KAAK,CAAE,CAAEE,OAAO,CAAE,OAAO,CAAED,YAAY,CAAE,CAAC,CAAEK,UAAU,CAAE,MAAO,CAAE,CAAAR,QAAA,CAAC,6FAAgB,CAAO,CAAC,cACjGnJ,KAAA,QAAKqJ,KAAK,CAAE,CAAEE,OAAO,CAAE,MAAM,CAAEE,GAAG,CAAE,CAAC,CAAEU,UAAU,CAAE,QAAS,CAAE,CAAAhB,QAAA,eAC5DrJ,IAAA,UAAO8J,IAAI,CAAC,QAAQ,CAACpB,GAAG,CAAE,CAAE,CAACnI,GAAG,CAAE,GAAI,CAACwJ,KAAK,CAAErH,OAAQ,CACpDsH,QAAQ,CAAGC,CAAC,EAAK,CAAEtH,UAAU,CAAC2H,MAAM,CAACL,CAAC,CAACE,MAAM,CAACJ,KAAK,CAAC,CAAC,CAAE7D,WAAW,CAACoE,MAAM,CAACL,CAAC,CAACE,MAAM,CAACJ,KAAK,CAAC,CAAEnH,SAAS,CAAC,CAAE,CAAE,CACzG2G,KAAK,CAAE,CAAEa,KAAK,CAAE,EAAE,CAAEG,OAAO,CAAE,KAAK,CAAEC,YAAY,CAAE,CAAC,CAAEC,MAAM,CAAE,mBAAmB,CAAEC,UAAU,CAAE,SAAS,CAAEhD,KAAK,CAAE,SAAU,CAAE,CAAE,CAAC,cACjI1H,IAAA,SAAMoJ,SAAS,CAAC,QAAQ,CAAAC,QAAA,CAAC,GAAC,CAAM,CAAC,cACjCrJ,IAAA,UAAO8J,IAAI,CAAC,QAAQ,CAACpB,GAAG,CAAE,CAAE,CAACnI,GAAG,CAAE,EAAG,CAACwJ,KAAK,CAAEnH,SAAU,CACrDoH,QAAQ,CAAGC,CAAC,EAAK,CAAEpH,YAAY,CAACyH,MAAM,CAACL,CAAC,CAACE,MAAM,CAACJ,KAAK,CAAC,CAAC,CAAE,CAAE,CAC3DR,KAAK,CAAE,CAAEa,KAAK,CAAE,GAAG,CAAEG,OAAO,CAAE,KAAK,CAAEC,YAAY,CAAE,CAAC,CAAEC,MAAM,CAAE,mBAAmB,CAAEC,UAAU,CAAE,SAAS,CAAEhD,KAAK,CAAE,SAAU,CAAE,CAAE,CAAC,cAClI1H,IAAA,SAAMoJ,SAAS,CAAC,QAAQ,CAAAC,QAAA,CAAC,oBAAG,CAAM,CAAC,EAChC,CAAC,EACH,CAAC,EACH,CAAC,cAENrJ,IAAA,WAAQsJ,OAAO,CAAE/D,YAAa,CAAC6D,SAAS,CAAC,QAAQ,CAACG,KAAK,CAAE,CAAEC,YAAY,CAAE,EAAG,CAAE,CAAAH,QAAA,CAAC,yDAE/E,CAAQ,CAAC,cAETrJ,IAAA,QAAKoJ,SAAS,CAAC,kBAAkB,CAAAC,QAAA,cAC/BrJ,IAAA,CAACJ,UAAU,EACT+K,QAAQ,CAAElJ,IAAI,CAACyF,GAAG,CAAC,CAAE,CACrB0D,WAAW,CAAEhC,UAAW,CACxBiC,UAAU,CAAE,GAAI,CAChBC,gBAAgB,CAAE3I,WAAW,GAAK,GAAG,CAAG,OAAO,CAAG,OAAQ,CAC3D,CAAC,CACC,CAAC,CAELN,UAAU,eACT7B,IAAA,QAAKoJ,SAAS,CAAC,OAAO,CAACG,KAAK,CAAE,CAAEwB,SAAS,CAAE,EAAE,CAAErD,KAAK,CAAE,SAAS,CAAEmC,UAAU,CAAE,MAAO,CAAE,CAAAR,QAAA,CACnFtH,MAAM,CACJ,CACN,CAEAE,UAAU,eACTjC,IAAA,QAAKoJ,SAAS,CAAC,OAAO,CAACG,KAAK,CAAE,CAAEwB,SAAS,CAAE,EAAE,CAAErD,KAAK,CAAE,SAAU,CAAE,CAAA2B,QAAA,CAAC,4KAEnE,CAAK,CACN,EACE,CAAC,cAENnJ,KAAA,QAAKkJ,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BnJ,KAAA,QAAKkJ,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/BrJ,IAAA,OAAIuJ,KAAK,CAAE,CAAEwB,SAAS,CAAE,CAAE,CAAE,CAAA1B,QAAA,CAAC,0BAAI,CAAI,CAAC,cACtCnJ,KAAA,QAAKqJ,KAAK,CAAE,CAAEE,OAAO,CAAE,MAAM,CAAEuB,aAAa,CAAE,QAAQ,CAAErB,GAAG,CAAE,CAAE,CAAE,CAAAN,QAAA,eAC/DnJ,KAAA,QAAKqJ,KAAK,CAAE,CAAEE,OAAO,CAAE,MAAM,CAAEC,cAAc,CAAE,eAAgB,CAAE,CAAAL,QAAA,eAC/DrJ,IAAA,SAAAqJ,QAAA,CAAM,gCAAK,CAAM,CAAC,cAClBrJ,IAAA,WAAAqJ,QAAA,CAASlJ,QAAQ,CAAC2F,cAAc,CAAC9C,GAAG,CAAC,CAAS,CAAC,EAC5C,CAAC,cACN9C,KAAA,QAAKqJ,KAAK,CAAE,CAAEE,OAAO,CAAE,MAAM,CAAEC,cAAc,CAAE,eAAgB,CAAE,CAAAL,QAAA,eAC/DrJ,IAAA,SAAAqJ,QAAA,CAAM,sCAAM,CAAM,CAAC,cACnBrJ,IAAA,WAAAqJ,QAAA,CAASlJ,QAAQ,CAAC2F,cAAc,CAAC7C,GAAG,CAAC,CAAS,CAAC,EAC5C,CAAC,EACH,CAAC,EACH,CAAC,cAEN/C,KAAA,QAAKkJ,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eACjCrJ,IAAA,OAAIuJ,KAAK,CAAE,CAAEwB,SAAS,CAAE,CAAE,CAAE,CAAA1B,QAAA,CAAC,2EAAa,CAAI,CAAC,CAC9CrI,IAAI,CAACE,MAAM,GAAK,CAAC,cAChBlB,IAAA,MAAGoJ,SAAS,CAAC,QAAQ,CAAAC,QAAA,CAAC,4EAAc,CAAG,CAAC,cAExCnJ,KAAA,UAAOqJ,KAAK,CAAE,CAAEa,KAAK,CAAE,MAAM,CAAEa,cAAc,CAAE,UAAW,CAAE,CAAA5B,QAAA,eAC1DrJ,IAAA,UAAAqJ,QAAA,cACEnJ,KAAA,OAAAmJ,QAAA,eACErJ,IAAA,OAAIuJ,KAAK,CAAE,CAAE2B,SAAS,CAAE,MAAM,CAAEd,KAAK,CAAE,EAAG,CAAE,CAAAf,QAAA,CAAC,GAAC,CAAI,CAAC,cACnDrJ,IAAA,OAAIuJ,KAAK,CAAE,CAAE2B,SAAS,CAAE,MAAO,CAAE,CAAA7B,QAAA,CAAC,gCAAK,CAAI,CAAC,cAC5CrJ,IAAA,OAAIuJ,KAAK,CAAE,CAAE2B,SAAS,CAAE,MAAO,CAAE,CAAA7B,QAAA,CAAC,sCAAM,CAAI,CAAC,EAC3C,CAAC,CACA,CAAC,cACRrJ,IAAA,UAAAqJ,QAAA,CACGrI,IAAI,CAACmK,GAAG,CAAEC,CAAC,eACVlL,KAAA,OAAAmJ,QAAA,eACEnJ,KAAA,OAAAmJ,QAAA,EAAK+B,CAAC,CAAChK,EAAE,CAAC,GAAC,EAAI,CAAC,cAChBpB,IAAA,OAAAqJ,QAAA,CAAK+B,CAAC,CAAC/J,CAAC,CAAK,CAAC,cACdrB,IAAA,OAAAqJ,QAAA,CAAK+B,CAAC,CAAC9J,CAAC,CAAK,CAAC,GAHP8J,CAAC,CAAChK,EAIP,CACL,CAAC,CACG,CAAC,EACH,CACR,EACE,CAAC,EACH,CAAC,EACH,CAAC,EACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAAG,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}